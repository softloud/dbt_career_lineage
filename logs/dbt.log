[0m21:46:06.403953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd5af0>]}


============================== 21:46:06.406487 | c82ebd7c-c87c-4dcd-9baa-50022b98bf81 ==============================
[0m21:46:06.406487 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:46:06.406803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m21:46:06.542773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c82ebd7c-c87c-4dcd-9baa-50022b98bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105887fe0>]}
[0m21:46:06.566631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c82ebd7c-c87c-4dcd-9baa-50022b98bf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e411f0>]}
[0m21:46:06.567287 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:46:06.571717 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:46:06.585424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m21:46:06.585684 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/staging/stg_ed_math_ugrad.sql
[0m21:46:06.585851 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/staging/stg_ed_statistics_phd.sql
[0m21:46:06.640000 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_meetup4.stg_ed_math_ugrad' (models/staging/stg_ed_math_ugrad.sql) depends on a source named 'raw_ft_unity_analytics_shares.account_games' which was not found
[0m21:46:06.647964 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.2700985, "process_user_time": 0.964349, "process_kernel_time": 0.104989, "process_mem_max_rss": "115539968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:46:06.648463 [debug] [MainThread]: Command `dbt docs generate` failed at 21:46:06.648364 after 0.27 seconds
[0m21:46:06.648724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105815670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d14650>]}
[0m21:46:06.648914 [debug] [MainThread]: Flushing usage events
[0m21:46:46.813766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511d970>]}


============================== 21:46:46.815774 | 08a13716-2605-4719-aff9-17789514b473 ==============================
[0m21:46:46.815774 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:46:46.816090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:46:46.931904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08a13716-2605-4719-aff9-17789514b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105703fb0>]}
[0m21:46:46.956154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08a13716-2605-4719-aff9-17789514b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144bc0>]}
[0m21:46:46.956506 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:46:46.960902 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:46:46.975039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m21:46:46.975343 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/staging/_ua__sources.yml
[0m21:46:46.975519 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/staging/stg_ed_math_ugrad.sql
[0m21:46:46.975677 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/staging/stg_ed_statistics_phd.sql
[0m21:46:47.062596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:46:47.064982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a13716-2605-4719-aff9-17789514b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621a150>]}
[0m21:46:47.066183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a13716-2605-4719-aff9-17789514b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106086900>]}
[0m21:46:47.066385 [info ] [MainThread]: Found 2 models, 3 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:46:47.066565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a13716-2605-4719-aff9-17789514b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628d0d0>]}
[0m21:46:47.067382 [info ] [MainThread]: 
[0m21:46:47.067785 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:46:47.068314 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:46:47.076213 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:46:47.076403 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:46:47.076551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:47.077992 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:46:47.078155 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:46:47.377745 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:47.379399 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:46:47.380543 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:46:47.617599 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:47.623344 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:46:47.682634 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:46:47.691959 [debug] [MainThread]: Using redshift connection "master"
[0m21:46:47.692243 [debug] [MainThread]: On master: BEGIN
[0m21:46:47.692454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:47.692779 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:46:47.692998 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:46:47.894829 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:47.895376 [debug] [MainThread]: Using redshift connection "master"
[0m21:46:47.895805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:46:48.024059 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:48.028678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a13716-2605-4719-aff9-17789514b473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561b860>]}
[0m21:46:48.029558 [debug] [MainThread]: On master: ROLLBACK
[0m21:46:48.089263 [debug] [MainThread]: On master: Close
[0m21:46:48.092399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:48.093278 [info ] [MainThread]: 
[0m21:46:48.099223 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:46:48.100553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:46:48.101057 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:46:48.104662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:46:48.106165 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:46:48.101313 => 21:46:48.105904
[0m21:46:48.106592 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:46:48.107071 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:46:48.106861 => 21:46:48.106879
[0m21:46:48.107906 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:46:48.108281 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:46:48.109274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:46:48.109847 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:46:48.112718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:46:48.113501 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:46:48.110106 => 21:46:48.113301
[0m21:46:48.113839 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:46:48.114234 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:46:48.114049 => 21:46:48.114062
[0m21:46:48.115044 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:46:48.115798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:48.116109 [debug] [MainThread]: Connection 'model.dbt_meetup4.stg_ed_statistics_phd' was properly closed.
[0m21:46:48.116680 [debug] [MainThread]: Command end result
[0m21:46:48.124458 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:46:48.124739 [info ] [MainThread]: Building catalog
[0m21:46:48.126570 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:46:48.142161 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:46:48.142463 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:46:48.142665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:48.142966 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:46:48.143157 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:46:48.370241 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:48.370908 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:46:48.371590 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('raw_ft_unity_analytics_shares') or upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('raw_ft_unity_analytics_shares') or upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('raw_ft_unity_analytics_shares') or upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:46:48.671952 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:48.685470 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:46:48.686100 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:46:48.762794 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:46:48.775239 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:46:48.775840 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('raw_ft_unity_analytics_shares') or upper(schema) = upper('dev_cgray'))
[0m21:46:49.844288 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:46:49.888411 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:46:49.942146 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:46:50.113989 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:46:50.114895 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.3246198, "process_user_time": 1.401978, "process_kernel_time": 0.1283, "process_mem_max_rss": "126402560", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:46:50.115223 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:46:50.115163 after 3.33 seconds
[0m21:46:50.115392 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:46:50.115518 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:46:50.115672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ff8650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062195b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ca870>]}
[0m21:46:50.115840 [debug] [MainThread]: Flushing usage events
[0m21:46:56.207773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f7d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f8cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fad670>]}


============================== 21:46:56.209912 | 07be7e77-5a51-485d-a468-ed81f2327237 ==============================
[0m21:46:56.209912 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:46:56.210229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m21:46:56.322660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07be7e77-5a51-485d-a468-ed81f2327237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127d3290>]}
[0m21:46:56.348260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07be7e77-5a51-485d-a468-ed81f2327237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124efa10>]}
[0m15:30:22.435840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124bea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e9940>]}


============================== 15:30:22.439170 | 5f0cb718-ef23-48e7-ad6f-f0f83609b298 ==============================
[0m15:30:22.439170 [info ] [MainThread]: Running with dbt=1.7.14
[0m15:30:22.439519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m15:30:22.601856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f0cb718-ef23-48e7-ad6f-f0f83609b298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11233f3e0>]}
[0m15:30:22.625684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f0cb718-ef23-48e7-ad6f-f0f83609b298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271afc0>]}
[0m15:30:22.626211 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m15:30:22.630975 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m15:30:22.655931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:22.656132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:22.656474 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m15:30:22.659178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f0cb718-ef23-48e7-ad6f-f0f83609b298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145d0cb0>]}
[0m15:30:22.660646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f0cb718-ef23-48e7-ad6f-f0f83609b298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4f9e0>]}
[0m15:30:22.660855 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m15:30:22.661025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0cb718-ef23-48e7-ad6f-f0f83609b298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dbadb0>]}
[0m15:30:22.661879 [info ] [MainThread]: 
[0m15:30:22.662284 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m15:30:22.662817 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m15:30:22.671014 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m15:30:22.671268 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m15:30:22.671431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:22.673046 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:30:22.673306 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:30:23.010832 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:23.012550 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m15:30:23.013674 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m15:30:23.098254 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:23.102258 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m15:30:23.168213 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m15:30:23.185204 [debug] [MainThread]: Using redshift connection "master"
[0m15:30:23.185834 [debug] [MainThread]: On master: BEGIN
[0m15:30:23.186130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:23.186647 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:30:23.186947 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:30:23.451888 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:23.453384 [debug] [MainThread]: Using redshift connection "master"
[0m15:30:23.454491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m15:30:23.587037 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:23.591943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f0cb718-ef23-48e7-ad6f-f0f83609b298', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dba9c0>]}
[0m15:30:23.592638 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:23.658888 [debug] [MainThread]: On master: Close
[0m15:30:23.661789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:23.662513 [info ] [MainThread]: 
[0m15:30:23.668397 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m15:30:23.669761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m15:30:23.670281 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m15:30:23.674110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m15:30:23.675730 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 15:30:23.670640 => 15:30:23.675267
[0m15:30:23.676284 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m15:30:23.676794 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 15:30:23.676552 => 15:30:23.676578
[0m15:30:23.677907 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m15:30:23.678339 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m15:30:23.679184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m15:30:23.679614 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m15:30:23.682687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m15:30:23.683436 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 15:30:23.679841 => 15:30:23.683238
[0m15:30:23.683766 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m15:30:23.684142 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 15:30:23.683964 => 15:30:23.683972
[0m15:30:23.684970 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m15:30:23.685896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:23.686245 [debug] [MainThread]: Connection 'model.dbt_meetup4.stg_ed_statistics_phd' was properly closed.
[0m15:30:23.686887 [debug] [MainThread]: Command end result
[0m15:30:23.696171 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m15:30:23.696426 [info ] [MainThread]: Building catalog
[0m15:30:23.698089 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m15:30:23.711832 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m15:30:23.712099 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m15:30:23.712289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:23.712577 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m15:30:23.712771 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m15:30:23.942047 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:23.943787 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m15:30:23.945288 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('raw_ft_unity_analytics_shares') or upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('raw_ft_unity_analytics_shares') or upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('raw_ft_unity_analytics_shares') or upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m15:30:24.183784 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:24.196892 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m15:30:24.197407 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m15:30:24.275663 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m15:30:24.290618 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m15:30:24.291430 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('raw_ft_unity_analytics_shares') or upper(schema) = upper('dev_cgray'))
[0m15:30:25.344241 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m15:30:25.368003 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m15:30:25.425320 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m15:30:25.511143 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m15:30:25.512761 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.1052237, "process_user_time": 1.225593, "process_kernel_time": 0.166423, "process_mem_max_rss": "122847232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:30:25.513096 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:30:25.513038 after 3.11 seconds
[0m15:30:25.513256 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:30:25.513379 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m15:30:25.513526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121dd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112510b60>]}
[0m15:30:25.513700 [debug] [MainThread]: Flushing usage events
[0m15:30:29.440139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107783350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ad880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ad400>]}


============================== 15:30:29.442459 | a040c9c1-ff4f-41d7-b03c-c3a7222fcc0f ==============================
[0m15:30:29.442459 [info ] [MainThread]: Running with dbt=1.7.14
[0m15:30:29.442775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:30:29.559340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a040c9c1-ff4f-41d7-b03c-c3a7222fcc0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077af3e0>]}
[0m15:30:29.583467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a040c9c1-ff4f-41d7-b03c-c3a7222fcc0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107665760>]}
[0m21:02:08.247182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dadd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dad910>]}


============================== 21:02:08.249760 | 4f0a8b9d-8f45-43bf-9309-c077fe6389c4 ==============================
[0m21:02:08.249760 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:02:08.250061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -s career_phase', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:02:08.398897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f0a8b9d-8f45-43bf-9309-c077fe6389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a523800>]}
[0m21:02:08.422631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f0a8b9d-8f45-43bf-9309-c077fe6389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8842f0>]}
[0m21:02:08.423117 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:02:08.427584 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:02:08.442208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:02:08.442398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:02:08.442701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:02:08.445296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f0a8b9d-8f45-43bf-9309-c077fe6389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e11c0>]}
[0m21:02:08.450523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f0a8b9d-8f45-43bf-9309-c077fe6389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af37c50>]}
[0m21:02:08.450776 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:02:08.451524 [info ] [MainThread]: 
[0m21:02:08.451925 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:02:08.452459 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics'
[0m21:02:08.460167 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics"
[0m21:02:08.460426 [debug] [ThreadPool]: On list_msw_data_analytics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics"} */

    select distinct nspname from pg_namespace
[0m21:02:08.460593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:02:08.462306 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:08.462484 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:08.745785 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:08.750406 [debug] [ThreadPool]: On list_msw_data_analytics: Close
[0m21:02:08.754137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_msw_data_analytics, now list_msw_data_analytics_dev_cgray)
[0m21:02:08.763453 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:02:08.763923 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:02:08.764222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:02:08.764702 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:08.765026 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:08.996639 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:08.998222 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:02:08.999315 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:02:09.080755 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:09.085355 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:02:09.142351 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:02:09.158537 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:09.159119 [debug] [MainThread]: On master: BEGIN
[0m21:02:09.159457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:02:09.159959 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:09.160301 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:09.388352 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:09.389709 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:09.390892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:02:09.523639 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:09.528298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f0a8b9d-8f45-43bf-9309-c077fe6389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4a600>]}
[0m21:02:09.529235 [debug] [MainThread]: On master: ROLLBACK
[0m21:02:09.744454 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:09.745688 [debug] [MainThread]: On master: BEGIN
[0m21:02:09.770246 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:09.770938 [debug] [MainThread]: On master: COMMIT
[0m21:02:09.771457 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:09.771808 [debug] [MainThread]: On master: COMMIT
[0m21:02:09.822449 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:09.823944 [debug] [MainThread]: On master: Close
[0m21:02:09.826631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:02:09.827140 [info ] [MainThread]: 
[0m21:02:09.832643 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.career_phase
[0m21:02:09.833448 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_cgray.career_phase ............................ [RUN]
[0m21:02:09.834436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.career_phase)
[0m21:02:09.834935 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.career_phase
[0m21:02:09.838918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.career_phase"
[0m21:02:09.840217 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.career_phase (compile): 21:02:09.835214 => 21:02:09.839934
[0m21:02:09.840690 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.career_phase
[0m21:02:09.878170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.career_phase"
[0m21:02:09.879381 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:09.879623 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: BEGIN
[0m21:02:09.879831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:02:09.880150 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:09.880365 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:10.496474 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:02:10.497304 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:10.497770 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.career_phase"} */

  
    

  create  table
    "msw_data_analytics"."dev_cgray"."career_phase__dbt_tmp"
    
    
    
  as (
    

select *
from "msw_data_analytics"."raw_ft_unity_analytics_shares"."account_games"
  );
[0m21:02:31.934300 [debug] [Thread-1 (]: SQL status: SUCCESS in 21.0 seconds
[0m21:02:31.952170 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:31.952762 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.career_phase"} */
alter table "msw_data_analytics"."dev_cgray"."career_phase__dbt_tmp" rename to "career_phase"
[0m21:02:32.067905 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:32.091122 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: COMMIT
[0m21:02:32.091717 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:32.092024 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: COMMIT
[0m21:02:32.286641 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:32.288905 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:32.290019 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: BEGIN
[0m21:02:32.337553 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:32.345676 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."career_phase__dbt_backup"
[0m21:02:32.350809 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:32.351184 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.career_phase"} */
drop table if exists "msw_data_analytics"."dev_cgray"."career_phase__dbt_backup" cascade
[0m21:02:32.399748 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:32.401017 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: COMMIT
[0m21:02:32.401578 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:32.402017 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: COMMIT
[0m21:02:32.436740 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:32.438354 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.career_phase"
[0m21:02:32.439493 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: BEGIN
[0m21:02:32.465561 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:32.467491 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.career_phase (execute): 21:02:09.841200 => 21:02:32.467132
[0m21:02:32.468121 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: ROLLBACK
[0m21:02:32.666071 [debug] [Thread-1 (]: On model.dbt_meetup4.career_phase: Close
[0m21:02:32.669434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f0a8b9d-8f45-43bf-9309-c077fe6389c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c165e50>]}
[0m21:02:32.671203 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_cgray.career_phase ....................... [[32mSUCCESS[0m in 22.84s]
[0m21:02:32.672535 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.career_phase
[0m21:02:32.674868 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:32.675354 [debug] [MainThread]: On master: BEGIN
[0m21:02:32.675773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:02:32.676511 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:02:32.676953 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:02:33.243164 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m21:02:33.244749 [debug] [MainThread]: On master: COMMIT
[0m21:02:33.246061 [debug] [MainThread]: Using redshift connection "master"
[0m21:02:33.246985 [debug] [MainThread]: On master: COMMIT
[0m21:02:33.295610 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:02:33.297030 [debug] [MainThread]: On master: Close
[0m21:02:33.299812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:02:33.300615 [debug] [MainThread]: Connection 'model.dbt_meetup4.career_phase' was properly closed.
[0m21:02:33.301135 [info ] [MainThread]: 
[0m21:02:33.301685 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 24.85 seconds (24.85s).
[0m21:02:33.302719 [debug] [MainThread]: Command end result
[0m21:02:33.314813 [info ] [MainThread]: 
[0m21:02:33.315436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:02:33.315805 [info ] [MainThread]: 
[0m21:02:33.316126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:02:33.318940 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 25.096363, "process_user_time": 1.247095, "process_kernel_time": 0.154953, "process_mem_max_rss": "124977152", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:02:33.319809 [debug] [MainThread]: Command `dbt build` succeeded at 21:02:33.319634 after 25.10 seconds
[0m21:02:33.320152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e19070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c166690>]}
[0m21:02:33.320388 [debug] [MainThread]: Flushing usage events
[0m21:03:22.561935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105321d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105321a00>]}


============================== 21:03:22.563950 | ec1eba1c-c15b-4aef-bf99-e6e548923391 ==============================
[0m21:03:22.563950 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:03:22.564272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:03:22.675691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec1eba1c-c15b-4aef-bf99-e6e548923391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105348290>]}
[0m21:03:22.699600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec1eba1c-c15b-4aef-bf99-e6e548923391', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d9b50>]}
[0m21:03:22.699935 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:03:22.704508 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:03:22.719226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:03:22.719643 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/_ua__sources.yml
[0m21:03:22.719826 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/stg_ed_math_ugrad.sql
[0m21:03:22.808734 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_meetup4.career_phase' (models/staging/career_phase.sql) depends on a source named 'raw_ft_unity_analytics_shares.account_games' which was not found
[0m21:03:22.809726 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.27159458, "process_user_time": 0.997279, "process_kernel_time": 0.085182, "process_mem_max_rss": "116867072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:22.810093 [debug] [MainThread]: Command `dbt docs generate` failed at 21:03:22.810023 after 0.27 seconds
[0m21:03:22.810325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034bf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064eeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f3c80>]}
[0m21:03:22.810502 [debug] [MainThread]: Flushing usage events
[0m21:03:44.671843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106280aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a9a90>]}


============================== 21:03:44.673988 | f34020f1-b3b3-455a-841b-cac2199a6799 ==============================
[0m21:03:44.673988 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:03:44.674302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m21:03:44.789293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f34020f1-b3b3-455a-841b-cac2199a6799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106660e00>]}
[0m21:03:44.813164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f34020f1-b3b3-455a-841b-cac2199a6799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106788fb0>]}
[0m21:03:44.813510 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:03:44.817893 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:03:44.832635 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m21:03:44.833032 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/_ua__sources.yml
[0m21:03:44.833201 [debug] [MainThread]: Partial parsing: deleted file: dbt_meetup4://models/staging/career_phase.sql
[0m21:03:44.833366 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/stg_ed_math_ugrad.sql
[0m21:03:44.919573 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_meetup4.stg_ed_statistics_phd' (models/staging/stg_ed_statistics_phd.sql) depends on a source named 'raw_ft_unity_analytics_shares.account_games' which was not found
[0m21:03:44.920579 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.27237076, "process_user_time": 0.984491, "process_kernel_time": 0.085083, "process_mem_max_rss": "117751808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:03:44.920934 [debug] [MainThread]: Command `dbt docs generate` failed at 21:03:44.920868 after 0.27 seconds
[0m21:03:44.921128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675a180>]}
[0m21:03:44.921296 [debug] [MainThread]: Flushing usage events
[0m21:04:03.684302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105980800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059add00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ad970>]}


============================== 21:04:03.686425 | a413dd96-55fc-450b-a95a-8285221015cd ==============================
[0m21:04:03.686425 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:04:03.686755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:03.800732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a413dd96-55fc-450b-a95a-8285221015cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106464110>]}
[0m21:04:03.824641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a413dd96-55fc-450b-a95a-8285221015cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdcce0>]}
[0m21:04:03.825002 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:04:03.829676 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:04:03.844556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:03.844770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:03.845109 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:04:03.847934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a413dd96-55fc-450b-a95a-8285221015cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065137a0>]}
[0m21:04:03.849112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a413dd96-55fc-450b-a95a-8285221015cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106983410>]}
[0m21:04:03.849336 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:04:03.849511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a413dd96-55fc-450b-a95a-8285221015cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106982ff0>]}
[0m21:04:03.850323 [info ] [MainThread]: 
[0m21:04:03.850734 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:04:03.851303 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:04:03.859053 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:04:03.859299 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:04:03.859454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:03.861100 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:04:03.861293 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:04:04.151627 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:04:04.153301 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:04:04.154436 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:04:04.237127 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:04:04.241472 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:04:04.293689 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:04:04.310860 [debug] [MainThread]: Using redshift connection "master"
[0m21:04:04.311430 [debug] [MainThread]: On master: BEGIN
[0m21:04:04.311769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:04:04.312305 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:04:04.312657 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:04:05.562244 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m21:04:05.563828 [debug] [MainThread]: Using redshift connection "master"
[0m21:04:05.565023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:04:05.693131 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:04:05.698835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a413dd96-55fc-450b-a95a-8285221015cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d3470>]}
[0m21:04:05.700175 [debug] [MainThread]: On master: ROLLBACK
[0m21:04:05.766588 [debug] [MainThread]: On master: Close
[0m21:04:05.769333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:05.769877 [info ] [MainThread]: 
[0m21:04:05.774015 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:04:05.775370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:04:05.775899 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:04:05.780083 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:04:05.781224 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:04:05.776229 => 21:04:05.780972
[0m21:04:05.781651 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:04:05.782136 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:04:05.781900 => 21:04:05.781921
[0m21:04:05.783402 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:04:05.784168 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:04:05.785011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:04:05.785396 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:04:05.788174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:04:05.788914 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:04:05.785627 => 21:04:05.788710
[0m21:04:05.789263 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:04:05.789647 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:04:05.789466 => 21:04:05.789474
[0m21:04:05.790460 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:04:05.791433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:05.791718 [debug] [MainThread]: Connection 'model.dbt_meetup4.stg_ed_statistics_phd' was properly closed.
[0m21:04:05.792348 [debug] [MainThread]: Command end result
[0m21:04:05.800708 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:04:05.800996 [info ] [MainThread]: Building catalog
[0m21:04:05.802449 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:04:05.815843 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:04:05.816111 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:04:05.816314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:05.816594 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:04:05.816784 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:04:06.031015 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:04:06.031731 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:04:06.032446 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:04:06.280150 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:04:06.290237 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:04:06.290856 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:04:06.367496 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:04:06.387881 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:04:06.388674 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:04:07.469035 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:04:07.496627 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:04:07.712008 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:04:07.798510 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:04:07.799446 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 4.1390557, "process_user_time": 1.236439, "process_kernel_time": 0.122447, "process_mem_max_rss": "124403712", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:04:07.799782 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:04:07.799719 after 4.14 seconds
[0m21:04:07.799951 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:04:07.800086 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:04:07.800248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b75e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aba300>]}
[0m21:04:07.800431 [debug] [MainThread]: Flushing usage events
[0m21:04:15.035335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101adbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ad820>]}


============================== 21:04:15.037566 | 9d74c64c-1827-4507-b5f4-e34fe5928746 ==============================
[0m21:04:15.037566 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:04:15.037886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:15.157107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d74c64c-1827-4507-b5f4-e34fe5928746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114fb3e0>]}
[0m21:04:15.182739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d74c64c-1827-4507-b5f4-e34fe5928746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d9cd0>]}
[0m21:11:04.505145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c81160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cadd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cada00>]}


============================== 21:11:04.507805 | 35932e95-3102-40e6-a8b5-f6a2de839881 ==============================
[0m21:11:04.507805 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:11:04.508111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:11:04.645688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35932e95-3102-40e6-a8b5-f6a2de839881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190042f0>]}
[0m21:11:04.669141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35932e95-3102-40e6-a8b5-f6a2de839881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119031670>]}
[0m21:11:04.669835 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:11:04.674242 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:11:04.689245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:11:04.689449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:11:04.689835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:11:04.692568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35932e95-3102-40e6-a8b5-f6a2de839881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190d4320>]}
[0m21:11:04.693818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35932e95-3102-40e6-a8b5-f6a2de839881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119138320>]}
[0m21:11:04.694029 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:11:04.694201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35932e95-3102-40e6-a8b5-f6a2de839881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8abd0>]}
[0m21:11:04.695097 [info ] [MainThread]: 
[0m21:11:04.695526 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:11:04.696172 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:11:04.703744 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:11:04.703920 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:11:04.704060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:04.705556 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:11:04.705757 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:11:05.024575 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:05.026180 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:11:05.027284 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:11:05.109363 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:05.113838 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:11:05.179150 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:11:05.194891 [debug] [MainThread]: Using redshift connection "master"
[0m21:11:05.195377 [debug] [MainThread]: On master: BEGIN
[0m21:11:05.195629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:05.196044 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:11:05.196842 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:11:05.534762 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:05.536290 [debug] [MainThread]: Using redshift connection "master"
[0m21:11:05.537423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:11:05.734239 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:05.738440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35932e95-3102-40e6-a8b5-f6a2de839881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11910cbc0>]}
[0m21:11:05.739297 [debug] [MainThread]: On master: ROLLBACK
[0m21:11:05.817149 [debug] [MainThread]: On master: Close
[0m21:11:05.820389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:05.821060 [info ] [MainThread]: 
[0m21:11:05.825654 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.careers
[0m21:11:05.827133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.careers)
[0m21:11:05.827946 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.careers
[0m21:11:05.830685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.careers"
[0m21:11:05.831953 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.careers (compile): 21:11:05.828302 => 21:11:05.831683
[0m21:11:05.832367 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.careers
[0m21:11:05.832837 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.careers (execute): 21:11:05.832616 => 21:11:05.832635
[0m21:11:05.833868 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.careers
[0m21:11:05.834317 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:11:05.835496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.careers, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:11:05.836044 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:11:05.839241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:11:05.840204 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:11:05.836269 => 21:11:05.839997
[0m21:11:05.840539 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:11:05.840911 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:11:05.840735 => 21:11:05.840745
[0m21:11:05.841777 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:11:05.842146 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:11:05.843111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:11:05.843641 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:11:05.846334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:11:05.847024 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:11:05.843896 => 21:11:05.846841
[0m21:11:05.847340 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:11:05.847664 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:11:05.847512 => 21:11:05.847519
[0m21:11:05.848394 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:11:05.848695 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:11:05.849227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:11:05.849484 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:11:05.851607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:11:05.852181 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:11:05.849646 => 21:11:05.852018
[0m21:11:05.852453 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:11:05.852796 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:11:05.852652 => 21:11:05.852657
[0m21:11:05.853471 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:11:05.853761 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:11:05.854231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_start_ups, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:11:05.854469 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:11:05.856265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:11:05.856853 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:11:05.854615 => 21:11:05.856706
[0m21:11:05.857101 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:11:05.857386 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:11:05.857246 => 21:11:05.857261
[0m21:11:05.857979 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:11:05.858438 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:11:05.858913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:11:05.859160 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:11:05.860949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:11:05.861461 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:11:05.859315 => 21:11:05.861325
[0m21:11:05.861703 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:11:05.861970 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:11:05.861843 => 21:11:05.861847
[0m21:11:05.862527 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:11:05.863097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:05.863289 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:11:05.864007 [debug] [MainThread]: Command end result
[0m21:11:05.872182 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:11:05.872433 [info ] [MainThread]: Building catalog
[0m21:11:05.873954 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:11:05.885446 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:11:05.885715 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:11:05.885891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:05.886168 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:11:05.886345 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:11:06.099029 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:06.100283 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:11:06.101035 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:11:06.351853 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:06.369145 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:11:06.370071 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:11:06.443008 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:11:06.456050 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:11:06.456645 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:11:07.461286 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:11:07.490538 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:11:07.536700 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:11:07.613689 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:11:07.615257 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.1361194, "process_user_time": 1.214149, "process_kernel_time": 0.142295, "process_mem_max_rss": "122372096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:11:07.615661 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:11:07.615592 after 3.14 seconds
[0m21:11:07.615853 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:11:07.615997 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:11:07.616169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cada00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119033dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ec46e0>]}
[0m21:11:07.616360 [debug] [MainThread]: Flushing usage events
[0m21:11:12.613852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ad4c0>]}


============================== 21:11:12.616020 | a3b5f772-324f-435d-ad3c-75c7ed7a5081 ==============================
[0m21:11:12.616020 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:11:12.616331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:12.731369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3b5f772-324f-435d-ad3c-75c7ed7a5081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071128d0>]}
[0m21:11:12.756342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3b5f772-324f-435d-ad3c-75c7ed7a5081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110673e30>]}
[0m21:12:46.045261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109204e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109231fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109231b80>]}


============================== 21:12:46.047788 | bf08df35-fc5b-4319-a52e-73c539ad0a31 ==============================
[0m21:12:46.047788 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:12:46.048111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:12:46.197548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf08df35-fc5b-4319-a52e-73c539ad0a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109516480>]}
[0m21:12:46.221341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf08df35-fc5b-4319-a52e-73c539ad0a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109670f20>]}
[0m21:12:46.221869 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:12:46.226239 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:12:46.241928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:46.242118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:46.242475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:12:46.245032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf08df35-fc5b-4319-a52e-73c539ad0a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109836390>]}
[0m21:12:46.246231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf08df35-fc5b-4319-a52e-73c539ad0a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a187620>]}
[0m21:12:46.246433 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:12:46.246606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf08df35-fc5b-4319-a52e-73c539ad0a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d59d60>]}
[0m21:12:46.247474 [info ] [MainThread]: 
[0m21:12:46.247891 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:12:46.248496 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:12:46.256085 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:12:46.256337 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:12:46.256510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.258144 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:12:46.258343 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:12:46.536840 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:46.538158 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:12:46.538994 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:12:46.615485 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:46.619376 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:12:46.669865 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:12:46.687506 [debug] [MainThread]: Using redshift connection "master"
[0m21:12:46.688171 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.688557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:46.689076 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:12:46.689373 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:12:46.919960 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:46.921506 [debug] [MainThread]: Using redshift connection "master"
[0m21:12:46.922185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:12:47.049762 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:47.055043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf08df35-fc5b-4319-a52e-73c539ad0a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096110a0>]}
[0m21:12:47.055870 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:47.116955 [debug] [MainThread]: On master: Close
[0m21:12:47.120028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:12:47.120885 [info ] [MainThread]: 
[0m21:12:47.126220 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.career
[0m21:12:47.127526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.career)
[0m21:12:47.128044 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.career
[0m21:12:47.130376 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.career"
[0m21:12:47.131506 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.career (compile): 21:12:47.128353 => 21:12:47.131245
[0m21:12:47.131921 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.career
[0m21:12:47.132382 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.career (execute): 21:12:47.132163 => 21:12:47.132182
[0m21:12:47.133536 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.career
[0m21:12:47.134379 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:12:47.135356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.career, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:12:47.135846 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:12:47.139088 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:12:47.139948 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:12:47.136134 => 21:12:47.139732
[0m21:12:47.140310 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:12:47.140694 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:12:47.140513 => 21:12:47.140522
[0m21:12:47.141533 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:12:47.141912 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:12:47.142603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:12:47.142915 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:12:47.145060 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:12:47.145648 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:12:47.143091 => 21:12:47.145482
[0m21:12:47.145948 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:12:47.146266 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:12:47.146113 => 21:12:47.146121
[0m21:12:47.146950 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:12:47.147252 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:12:47.147779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:12:47.148040 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:12:47.150085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:12:47.150605 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:12:47.148214 => 21:12:47.150444
[0m21:12:47.150877 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:12:47.151215 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:12:47.151054 => 21:12:47.151059
[0m21:12:47.151866 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:12:47.152174 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:12:47.152664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_start_ups, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:12:47.152893 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:12:47.154670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:12:47.155108 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:12:47.153037 => 21:12:47.154967
[0m21:12:47.155346 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:12:47.155624 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:12:47.155493 => 21:12:47.155497
[0m21:12:47.156198 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:12:47.156682 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:12:47.157253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:12:47.157521 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:12:47.159401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:12:47.159918 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:12:47.157686 => 21:12:47.159765
[0m21:12:47.160184 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:12:47.160462 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:12:47.160333 => 21:12:47.160340
[0m21:12:47.161032 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:12:47.161585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:12:47.161796 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:12:47.162536 [debug] [MainThread]: Command end result
[0m21:12:47.169999 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:12:47.170193 [info ] [MainThread]: Building catalog
[0m21:12:47.171710 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:12:47.184028 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:12:47.184280 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:12:47.184447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:47.184705 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:12:47.184895 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:12:47.374385 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:47.374976 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:12:47.375554 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:12:47.595186 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:47.602903 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:12:47.603313 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:12:47.678733 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:12:47.685588 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:12:47.685975 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:12:48.583995 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:12:48.611436 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:12:48.654009 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:12:48.733395 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:12:48.735109 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.715315, "process_user_time": 1.218318, "process_kernel_time": 0.143598, "process_mem_max_rss": "123420672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:12:48.735459 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:12:48.735388 after 2.72 seconds
[0m21:12:48.735626 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:12:48.735779 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:12:48.735944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e46cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109204e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092cdf40>]}
[0m21:12:48.736130 [debug] [MainThread]: Flushing usage events
[0m21:12:51.869044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10497c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043fe630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a99d0>]}


============================== 21:12:51.871090 | dfd6f6b1-50b6-451e-9aed-a81839f76748 ==============================
[0m21:12:51.871090 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:12:51.871414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:12:51.986271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfd6f6b1-50b6-451e-9aed-a81839f76748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8ba10>]}
[0m21:12:52.010995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfd6f6b1-50b6-451e-9aed-a81839f76748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2f200>]}
[0m21:15:03.280212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108511e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108511a90>]}


============================== 21:15:03.282766 | 570b7c04-9333-4ddc-b515-e9d8688975ef ==============================
[0m21:15:03.282766 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:15:03.283073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:03.420436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '570b7c04-9333-4ddc-b515-e9d8688975ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108538740>]}
[0m21:15:03.444187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '570b7c04-9333-4ddc-b515-e9d8688975ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c1b80>]}
[0m21:15:03.444836 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:15:03.449313 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:15:03.463775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:03.464017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:03.464488 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:15:03.467276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '570b7c04-9333-4ddc-b515-e9d8688975ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109027020>]}
[0m21:15:03.468490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '570b7c04-9333-4ddc-b515-e9d8688975ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094585c0>]}
[0m21:15:03.468697 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:15:03.468874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570b7c04-9333-4ddc-b515-e9d8688975ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f6fc0>]}
[0m21:15:03.469849 [info ] [MainThread]: 
[0m21:15:03.470363 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:15:03.470984 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:15:03.478956 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:15:03.479146 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:15:03.479285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:03.480935 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:15:03.481126 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:15:03.775403 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:03.776067 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:15:03.776512 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:15:03.862198 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:03.866541 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:15:03.921601 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:15:03.940375 [debug] [MainThread]: Using redshift connection "master"
[0m21:15:03.940953 [debug] [MainThread]: On master: BEGIN
[0m21:15:03.941291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:03.941787 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:15:03.942124 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:15:04.171853 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:04.172913 [debug] [MainThread]: Using redshift connection "master"
[0m21:15:04.173478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:15:04.311998 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:04.318381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570b7c04-9333-4ddc-b515-e9d8688975ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f80590>]}
[0m21:15:04.319287 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:04.384482 [debug] [MainThread]: On master: Close
[0m21:15:04.386408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:15:04.386921 [info ] [MainThread]: 
[0m21:15:04.391738 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.career
[0m21:15:04.393047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.career)
[0m21:15:04.393874 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.career
[0m21:15:04.396417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.career"
[0m21:15:04.397530 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.career (compile): 21:15:04.394265 => 21:15:04.397280
[0m21:15:04.397949 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.career
[0m21:15:04.398435 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.career (execute): 21:15:04.398206 => 21:15:04.398224
[0m21:15:04.399455 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.career
[0m21:15:04.399854 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:15:04.400650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.career, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:15:04.401055 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:15:04.404133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:15:04.404981 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:15:04.401275 => 21:15:04.404772
[0m21:15:04.405341 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:15:04.405727 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:15:04.405547 => 21:15:04.405561
[0m21:15:04.406596 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:15:04.406943 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:15:04.407501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:15:04.407871 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:15:04.410159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:15:04.410786 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:15:04.408120 => 21:15:04.410620
[0m21:15:04.411089 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:15:04.411436 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:15:04.411266 => 21:15:04.411271
[0m21:15:04.412156 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:15:04.412476 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:15:04.413026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:15:04.413321 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:15:04.415298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:15:04.415784 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:15:04.413483 => 21:15:04.415643
[0m21:15:04.416028 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:15:04.416312 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:15:04.416183 => 21:15:04.416188
[0m21:15:04.416913 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:15:04.417180 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:15:04.417640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_start_ups, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:15:04.417870 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:15:04.419657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:15:04.420106 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:15:04.418014 => 21:15:04.419965
[0m21:15:04.420347 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:15:04.420619 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:15:04.420492 => 21:15:04.420497
[0m21:15:04.421209 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:15:04.421649 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:15:04.422129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:15:04.422358 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:15:04.424106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:15:04.424580 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:15:04.422514 => 21:15:04.424434
[0m21:15:04.424820 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:15:04.425113 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:15:04.424980 => 21:15:04.424985
[0m21:15:04.425678 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:15:04.426181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:04.426383 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:15:04.427106 [debug] [MainThread]: Command end result
[0m21:15:04.436066 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:15:04.436311 [info ] [MainThread]: Building catalog
[0m21:15:04.437860 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:15:04.449199 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:15:04.449428 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:15:04.449589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:04.449847 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:15:04.450022 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:15:04.674697 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:04.675826 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:15:04.676565 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:15:04.904047 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:04.913311 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:15:04.913949 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:15:04.998547 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:15:05.014264 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:15:05.015093 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:15:05.982352 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:15:06.009166 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:15:06.061119 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:15:06.137776 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:15:06.139371 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.8850594, "process_user_time": 1.229865, "process_kernel_time": 0.138659, "process_mem_max_rss": "123731968", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:15:06.139731 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:15:06.139667 after 2.89 seconds
[0m21:15:06.139907 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:15:06.140048 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:15:06.140211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a84590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10942f0b0>]}
[0m21:15:06.140394 [debug] [MainThread]: Flushing usage events
[0m21:15:09.410597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d35100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d65760>]}


============================== 21:15:09.412699 | 43859c7f-e2b6-45d0-8475-f1a96fdeed7d ==============================
[0m21:15:09.412699 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:15:09.413015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:09.530728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43859c7f-e2b6-45d0-8475-f1a96fdeed7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c1f3e0>]}
[0m21:15:09.556390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43859c7f-e2b6-45d0-8475-f1a96fdeed7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ad340>]}
[0m21:17:33.520934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ba120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046976b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e18e0>]}


============================== 21:17:33.523574 | 5ad13026-c8a1-43e2-b4ab-6d2163aa58e9 ==============================
[0m21:17:33.523574 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:17:33.523891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s +exposure:career', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:17:33.661668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ad13026-c8a1-43e2-b4ab-6d2163aa58e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500a630>]}
[0m21:17:33.685096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ad13026-c8a1-43e2-b4ab-6d2163aa58e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0cc50>]}
[0m21:17:33.685746 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:17:33.690246 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:17:33.705442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:33.705651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:33.706039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_meetup4.example
[0m21:17:33.708742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ad13026-c8a1-43e2-b4ab-6d2163aa58e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e3c80>]}
[0m21:17:33.713984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ad13026-c8a1-43e2-b4ab-6d2163aa58e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598cc20>]}
[0m21:17:33.714215 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:17:33.714402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ad13026-c8a1-43e2-b4ab-6d2163aa58e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598c0e0>]}
[0m21:17:33.714670 [warn ] [MainThread]: The selection criterion '+exposure:career' does not match any nodes
[0m21:17:33.715204 [info ] [MainThread]: 
[0m21:17:33.715372 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:17:33.715613 [debug] [MainThread]: Command end result
[0m21:17:33.719321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.22338079, "process_user_time": 0.921221, "process_kernel_time": 0.104016, "process_mem_max_rss": "114507776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:33.719646 [debug] [MainThread]: Command `dbt run` succeeded at 21:17:33.719582 after 0.22 seconds
[0m21:17:33.719851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046976b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104991bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d0d70>]}
[0m21:17:33.720021 [debug] [MainThread]: Flushing usage events
[0m21:18:30.271541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076836e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ad8b0>]}


============================== 21:18:30.273615 | 6dd0cb35-12b2-4535-ba83-e92d27e21d87 ==============================
[0m21:18:30.273615 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:18:30.273938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s +exposure:career', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:30.387016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd0cb35-12b2-4535-ba83-e92d27e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8f6e0>]}
[0m21:18:30.410919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd0cb35-12b2-4535-ba83-e92d27e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107680b30>]}
[0m21:18:30.411278 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:18:30.415699 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:18:30.430449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:30.430665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:30.433595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd0cb35-12b2-4535-ba83-e92d27e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082766f0>]}
[0m21:18:30.438396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd0cb35-12b2-4535-ba83-e92d27e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f8320>]}
[0m21:18:30.438626 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:18:30.438806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd0cb35-12b2-4535-ba83-e92d27e21d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076adca0>]}
[0m21:18:30.439090 [warn ] [MainThread]: The selection criterion '+exposure:career' does not match any nodes
[0m21:18:30.439627 [info ] [MainThread]: 
[0m21:18:30.439792 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:18:30.440033 [debug] [MainThread]: Command end result
[0m21:18:30.443630 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.1958135, "process_user_time": 0.91246, "process_kernel_time": 0.085897, "process_mem_max_rss": "115474432", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:18:30.444117 [debug] [MainThread]: Command `dbt run` succeeded at 21:18:30.444018 after 0.20 seconds
[0m21:18:30.444354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bef3b0>]}
[0m21:18:30.444549 [debug] [MainThread]: Flushing usage events
[0m21:19:51.220949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108355b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083557c0>]}


============================== 21:19:51.222966 | f4cfc563-4d87-4524-9534-81ebffe8b43e ==============================
[0m21:19:51.222966 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:19:51.223280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +exposure:career', 'send_anonymous_usage_stats': 'True'}
[0m21:19:51.336422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4cfc563-4d87-4524-9534-81ebffe8b43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837deb0>]}
[0m21:19:51.360489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4cfc563-4d87-4524-9534-81ebffe8b43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f47d0>]}
[0m21:19:51.360876 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:19:51.365525 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:19:51.381155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:51.381398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:51.384589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4cfc563-4d87-4524-9534-81ebffe8b43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897a510>]}
[0m21:19:51.389452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4cfc563-4d87-4524-9534-81ebffe8b43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092947d0>]}
[0m21:19:51.389728 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:19:51.389917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4cfc563-4d87-4524-9534-81ebffe8b43e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e01b80>]}
[0m21:19:51.390258 [warn ] [MainThread]: The selection criterion '+exposure:career' does not match any nodes
[0m21:19:51.390855 [info ] [MainThread]: 
[0m21:19:51.391017 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:19:51.391264 [debug] [MainThread]: Command end result
[0m21:19:51.394931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.19802304, "process_user_time": 0.926596, "process_kernel_time": 0.085612, "process_mem_max_rss": "115965952", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:19:51.395295 [debug] [MainThread]: Command `dbt run` succeeded at 21:19:51.395223 after 0.20 seconds
[0m21:19:51.395509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083557c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895a330>]}
[0m21:19:51.395684 [debug] [MainThread]: Flushing usage events
[0m21:20:15.427538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083dd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108409d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084099d0>]}


============================== 21:20:15.429637 | 42dcfce4-f1b9-465c-9327-df243a4e66f7 ==============================
[0m21:20:15.429637 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:20:15.429950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s +exposure:career', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:15.542591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42dcfce4-f1b9-465c-9327-df243a4e66f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb3f80>]}
[0m21:20:15.566606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42dcfce4-f1b9-465c-9327-df243a4e66f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e4440>]}
[0m21:20:15.566941 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:20:15.571578 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:20:15.586565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:15.586802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:15.590017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42dcfce4-f1b9-465c-9327-df243a4e66f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2f950>]}
[0m21:20:15.595291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42dcfce4-f1b9-465c-9327-df243a4e66f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935afc0>]}
[0m21:20:15.595574 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:20:15.595753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42dcfce4-f1b9-465c-9327-df243a4e66f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108430d40>]}
[0m21:20:15.596057 [warn ] [MainThread]: The selection criterion '+exposure:career' does not match any nodes
[0m21:20:15.596561 [info ] [MainThread]: 
[0m21:20:15.596713 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:20:15.596939 [debug] [MainThread]: Command end result
[0m21:20:15.600482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.19658388, "process_user_time": 0.918367, "process_kernel_time": 0.092392, "process_mem_max_rss": "115277824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:20:15.600773 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:15.600713 after 0.20 seconds
[0m21:20:15.600968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108688bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c693a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108409d30>]}
[0m21:20:15.601137 [debug] [MainThread]: Flushing usage events
[0m21:20:23.347848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110083c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100adc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ad8b0>]}


============================== 21:20:23.349982 | 2458f7a6-9226-4661-ab77-4b32af5b00a4 ==============================
[0m21:20:23.349982 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:20:23.350305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s +exposure:career_path', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:20:23.463795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2458f7a6-9226-4661-ab77-4b32af5b00a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106024e30>]}
[0m21:20:23.487677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2458f7a6-9226-4661-ab77-4b32af5b00a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110395940>]}
[0m21:20:23.488011 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:20:23.492685 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:20:23.507803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:23.508052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:23.511178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2458f7a6-9226-4661-ab77-4b32af5b00a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a40e0>]}
[0m21:20:23.516294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2458f7a6-9226-4661-ab77-4b32af5b00a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a3f560>]}
[0m21:20:23.516529 [info ] [MainThread]: Found 6 models, 1 source, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:20:23.516709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2458f7a6-9226-4661-ab77-4b32af5b00a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e1070>]}
[0m21:20:23.517014 [warn ] [MainThread]: The selection criterion '+exposure:career_path' does not match any nodes
[0m21:20:23.517575 [info ] [MainThread]: 
[0m21:20:23.517739 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:20:23.517981 [debug] [MainThread]: Command end result
[0m21:20:23.521520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.19830562, "process_user_time": 0.918021, "process_kernel_time": 0.087679, "process_mem_max_rss": "115884032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:20:23.521904 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:23.521810 after 0.20 seconds
[0m21:20:23.522138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ad8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11030a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f12e0>]}
[0m21:20:23.522322 [debug] [MainThread]: Flushing usage events
[0m21:21:56.219099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104801e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482d850>]}


============================== 21:21:56.221162 | 7d493701-f056-4b17-9fe8-91afd90e8ec4 ==============================
[0m21:21:56.221162 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:21:56.221471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s +exposure:career_path', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:21:56.337063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105297200>]}
[0m21:21:56.361380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b116d0>]}
[0m21:21:56.361793 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:21:56.366409 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:21:56.382040 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:21:56.382392 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/exposures/career_path.yml
[0m21:21:56.382559 [debug] [MainThread]: Partial parsing: deleted file: dbt_meetup4://models/exposures/career_path.sql
[0m21:21:56.399242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057408c0>]}
[0m21:21:56.403567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d8b60>]}
[0m21:21:56.403805 [info ] [MainThread]: Found 5 models, 1 source, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:21:56.403986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044754c0>]}
[0m21:21:56.405016 [info ] [MainThread]: 
[0m21:21:56.405422 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:21:56.406012 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics'
[0m21:21:56.413502 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics"
[0m21:21:56.413694 [debug] [ThreadPool]: On list_msw_data_analytics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics"} */

    select distinct nspname from pg_namespace
[0m21:21:56.413849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:56.415296 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:21:56.415483 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:21:56.739416 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:56.745364 [debug] [ThreadPool]: On list_msw_data_analytics: Close
[0m21:21:56.749165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_msw_data_analytics, now list_msw_data_analytics_dev_cgray)
[0m21:21:56.758051 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:21:56.758428 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:21:56.758734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:56.759206 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:21:56.759537 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:21:56.981058 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:56.982475 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:21:56.983296 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:21:57.063951 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:57.067994 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:21:57.125872 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:21:57.139179 [debug] [MainThread]: Using redshift connection "master"
[0m21:21:57.139787 [debug] [MainThread]: On master: BEGIN
[0m21:21:57.140123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:57.140600 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:21:57.140944 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:21:57.362047 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:57.363438 [debug] [MainThread]: Using redshift connection "master"
[0m21:21:57.364589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:21:57.494450 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:57.499741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597ff20>]}
[0m21:21:57.500488 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:57.567144 [debug] [MainThread]: Using redshift connection "master"
[0m21:21:57.568338 [debug] [MainThread]: On master: BEGIN
[0m21:21:57.594966 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:57.596158 [debug] [MainThread]: On master: COMMIT
[0m21:21:57.597295 [debug] [MainThread]: Using redshift connection "master"
[0m21:21:57.598192 [debug] [MainThread]: On master: COMMIT
[0m21:21:57.647146 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:57.648600 [debug] [MainThread]: On master: Close
[0m21:21:57.651525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:57.652360 [info ] [MainThread]: 
[0m21:21:57.657471 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:21:57.658431 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_cgray.stg_ed_math_ugrad ........................ [RUN]
[0m21:21:57.659461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:21:57.659885 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:21:57.663323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:57.664615 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:21:57.660140 => 21:21:57.664345
[0m21:21:57.665107 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:21:57.694144 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:57.695341 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:57.695647 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:21:57.695898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:57.696264 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:21:57.696525 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:21:57.907653 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:57.909378 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:57.910611 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */


  create view "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_tmp" as (
    select *
from "msw_data_analytics"."dev_cgray"."career_phase"
  ) ;
[0m21:21:58.008235 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.020810 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:58.021482 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
alter table "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_tmp" rename to "stg_ed_math_ugrad"
[0m21:21:58.098735 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.120259 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:21:58.120904 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:58.121236 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:21:58.296852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.298927 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:58.299496 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:21:58.349211 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.366895 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_backup"
[0m21:21:58.372126 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:58.372543 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
drop view if exists "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_backup" cascade
[0m21:21:58.417662 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.418784 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:21:58.419267 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:58.419641 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:21:58.536280 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.537960 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:21:58.539070 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:21:58.561535 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.563134 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:21:57.665357 => 21:21:58.562840
[0m21:21:58.563605 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: ROLLBACK
[0m21:21:58.616659 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: Close
[0m21:21:58.619449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b76000>]}
[0m21:21:58.620324 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_cgray.stg_ed_math_ugrad ................... [[32mSUCCESS[0m in 0.96s]
[0m21:21:58.621448 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:21:58.622731 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:21:58.623538 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_cgray.int_pipeline_pilot ....................... [RUN]
[0m21:21:58.624800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:21:58.625264 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:21:58.628609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:58.629644 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:21:58.625528 => 21:21:58.629415
[0m21:21:58.630044 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:21:58.634235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:58.635649 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:58.635998 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: BEGIN
[0m21:21:58.636319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:58.636796 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:21:58.637145 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:21:58.845237 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.847094 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:58.848264 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.int_pipeline_pilot"} */


  create view "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_tmp" as (
    select * from "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad"
  ) ;
[0m21:21:58.945766 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:58.954190 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:58.954868 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.int_pipeline_pilot"} */
alter table "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_tmp" rename to "int_pipeline_pilot"
[0m21:21:59.023008 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.028518 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:21:59.029294 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:59.030096 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:21:59.189098 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.190285 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:59.190874 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: BEGIN
[0m21:21:59.235858 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.242553 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_backup"
[0m21:21:59.244251 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:59.244583 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.int_pipeline_pilot"} */
drop view if exists "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_backup" cascade
[0m21:21:59.289205 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.290344 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:21:59.290826 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:59.291189 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:21:59.430113 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.432386 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:21:59.433580 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: BEGIN
[0m21:21:59.456783 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.460257 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:21:58.630283 => 21:21:59.459496
[0m21:21:59.461606 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: ROLLBACK
[0m21:21:59.513734 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: Close
[0m21:21:59.517520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b432f0>]}
[0m21:21:59.518710 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_cgray.int_pipeline_pilot .................. [[32mSUCCESS[0m in 0.89s]
[0m21:21:59.519568 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:21:59.520706 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:21:59.521701 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_cgray.bioinformatics ........................... [RUN]
[0m21:21:59.522945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:21:59.523455 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:21:59.527136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:21:59.528210 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:21:59.523756 => 21:21:59.527964
[0m21:21:59.528622 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:21:59.533570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.bioinformatics"
[0m21:21:59.534883 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:21:59.535265 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: BEGIN
[0m21:21:59.535582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:59.536039 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:21:59.536367 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:21:59.761495 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.763057 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:21:59.763681 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.bioinformatics"} */


  create view "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_tmp" as (
    select * from "msw_data_analytics"."dev_cgray"."int_pipeline_pilot"
  ) ;
[0m21:21:59.862971 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.870573 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:21:59.871375 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.bioinformatics"} */
alter table "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_tmp" rename to "bioinformatics"
[0m21:21:59.949761 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:21:59.955809 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:21:59.957133 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:21:59.958192 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:22:00.105619 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.108639 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:22:00.109791 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: BEGIN
[0m21:22:00.155482 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.157972 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_backup"
[0m21:22:00.158913 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:22:00.159188 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.bioinformatics"} */
drop view if exists "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_backup" cascade
[0m21:22:00.208119 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.208912 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:22:00.209232 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:22:00.209493 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:22:00.354359 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.356061 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:22:00.357174 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: BEGIN
[0m21:22:00.381181 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.384469 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:21:59.528864 => 21:22:00.383766
[0m21:22:00.385581 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: ROLLBACK
[0m21:22:00.434382 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: Close
[0m21:22:00.437689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d493701-f056-4b17-9fe8-91afd90e8ec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5ca70>]}
[0m21:22:00.439463 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_cgray.bioinformatics ...................... [[32mSUCCESS[0m in 0.91s]
[0m21:22:00.440809 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:22:00.443300 [debug] [MainThread]: Using redshift connection "master"
[0m21:22:00.443898 [debug] [MainThread]: On master: BEGIN
[0m21:22:00.444386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:22:00.445185 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:22:00.445680 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:22:00.661115 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.662793 [debug] [MainThread]: On master: COMMIT
[0m21:22:00.664160 [debug] [MainThread]: Using redshift connection "master"
[0m21:22:00.665125 [debug] [MainThread]: On master: COMMIT
[0m21:22:00.710257 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:00.711508 [debug] [MainThread]: On master: Close
[0m21:22:00.714210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:00.714849 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:22:00.715509 [info ] [MainThread]: 
[0m21:22:00.716099 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m21:22:00.717425 [debug] [MainThread]: Command end result
[0m21:22:00.733960 [info ] [MainThread]: 
[0m21:22:00.734455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:22:00.734790 [info ] [MainThread]: 
[0m21:22:00.735145 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:22:00.736648 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5414906, "process_user_time": 1.432637, "process_kernel_time": 0.151322, "process_mem_max_rss": "125566976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:22:00.737152 [debug] [MainThread]: Command `dbt run` succeeded at 21:22:00.737047 after 4.54 seconds
[0m21:22:00.737493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104801e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b970b0>]}
[0m21:22:00.737818 [debug] [MainThread]: Flushing usage events
[0m21:22:05.756039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebe090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee9a60>]}


============================== 21:22:05.758124 | 3d35cab2-6a37-40ac-9547-daf89a0a3ed0 ==============================
[0m21:22:05.758124 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:22:05.758437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:22:05.871130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d35cab2-6a37-40ac-9547-daf89a0a3ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eebb30>]}
[0m21:22:05.894977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d35cab2-6a37-40ac-9547-daf89a0a3ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080096d0>]}
[0m21:22:05.895315 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:22:05.899928 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:22:05.914427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:22:05.914626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:22:05.917515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d35cab2-6a37-40ac-9547-daf89a0a3ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d24e0>]}
[0m21:22:05.918886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d35cab2-6a37-40ac-9547-daf89a0a3ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089585f0>]}
[0m21:22:05.919118 [info ] [MainThread]: Found 5 models, 1 source, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:22:05.919310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d35cab2-6a37-40ac-9547-daf89a0a3ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0baa0>]}
[0m21:22:05.920253 [info ] [MainThread]: 
[0m21:22:05.920706 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:22:05.921436 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:22:05.929593 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:22:05.929825 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:22:05.929976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:05.931601 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:22:05.931803 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:22:06.195850 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:06.197554 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:22:06.198697 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:22:06.285761 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:06.291217 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:22:06.351233 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:22:06.371751 [debug] [MainThread]: Using redshift connection "master"
[0m21:22:06.372019 [debug] [MainThread]: On master: BEGIN
[0m21:22:06.372164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:06.372424 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:22:06.372564 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:22:06.601951 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:06.603543 [debug] [MainThread]: Using redshift connection "master"
[0m21:22:06.604799 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:22:06.736071 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:06.743181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d35cab2-6a37-40ac-9547-daf89a0a3ed0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f0110>]}
[0m21:22:06.744002 [debug] [MainThread]: On master: ROLLBACK
[0m21:22:06.809366 [debug] [MainThread]: On master: Close
[0m21:22:06.812724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:22:06.813668 [info ] [MainThread]: 
[0m21:22:06.817298 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:22:06.818705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:22:06.819236 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:22:06.823102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:22:06.824264 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:22:06.819571 => 21:22:06.823999
[0m21:22:06.824694 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:22:06.825157 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:22:06.824938 => 21:22:06.824956
[0m21:22:06.826166 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:22:06.826614 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:22:06.827816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:22:06.828311 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:22:06.831468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:22:06.832443 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:22:06.828537 => 21:22:06.832226
[0m21:22:06.832796 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:22:06.833189 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:22:06.833000 => 21:22:06.833011
[0m21:22:06.834030 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:22:06.834355 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:22:06.835135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:22:06.835616 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:22:06.838232 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:22:06.839010 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:22:06.835823 => 21:22:06.838827
[0m21:22:06.839315 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:22:06.839671 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:22:06.839507 => 21:22:06.839515
[0m21:22:06.840385 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:22:06.840708 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:22:06.841253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_start_ups, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:22:06.841537 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:22:06.843644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:22:06.844117 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:22:06.841730 => 21:22:06.843974
[0m21:22:06.844360 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:22:06.844651 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:22:06.844520 => 21:22:06.844525
[0m21:22:06.845255 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:22:06.845713 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:22:06.846297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:22:06.846599 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:22:06.848487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:22:06.849027 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:22:06.846774 => 21:22:06.848871
[0m21:22:06.849287 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:22:06.849581 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:22:06.849440 => 21:22:06.849445
[0m21:22:06.850192 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:22:06.850774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:22:06.851012 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:22:06.851687 [debug] [MainThread]: Command end result
[0m21:22:06.858245 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:22:06.858470 [info ] [MainThread]: Building catalog
[0m21:22:06.859976 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:22:06.872961 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:22:06.873208 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:22:06.873380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:22:06.873658 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:22:06.873839 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:22:07.069295 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:07.069779 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:22:07.070203 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:22:07.290923 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:07.302219 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:22:07.302854 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:22:07.375105 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:22:07.390616 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:22:07.391449 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:22:08.481213 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:22:08.505378 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:22:08.547302 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:22:08.625066 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:22:08.626046 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.8939395, "process_user_time": 1.220383, "process_kernel_time": 0.118149, "process_mem_max_rss": "123961344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:22:08.626364 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:22:08.626303 after 2.89 seconds
[0m21:22:08.626524 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:22:08.626653 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:22:08.626805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108023680>]}
[0m21:22:08.626981 [debug] [MainThread]: Flushing usage events
[0m21:22:12.702198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d11af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d11790>]}


============================== 21:22:12.704211 | 3e10de8a-ca31-4ec8-8896-21ae2150f20b ==============================
[0m21:22:12.704211 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:22:12.704532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:22:12.819335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e10de8a-ca31-4ec8-8896-21ae2150f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107780440>]}
[0m21:22:12.844969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e10de8a-ca31-4ec8-8896-21ae2150f20b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106daeb10>]}
[0m21:25:22.135571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095824e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095a96d0>]}


============================== 21:25:22.137557 | b51dd19b-a4e6-4ba9-b801-169b023affd4 ==============================
[0m21:25:22.137557 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:25:22.137900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build -s stg_ed_math_ugrad', 'send_anonymous_usage_stats': 'True'}
[0m21:25:22.254584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b51dd19b-a4e6-4ba9-b801-169b023affd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dd33e0>]}
[0m21:25:22.278431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b51dd19b-a4e6-4ba9-b801-169b023affd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8c110>]}
[0m21:25:22.278776 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:25:22.283195 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:25:22.298282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:25:22.298636 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/stg_start_ups.sql
[0m21:25:22.298856 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/stg_ed_math_ugrad.sql
[0m21:25:22.347885 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_start_ups (models/staging/stg_start_ups.sql)
  unexpected '}', expected ')'
    line 1
      {{config(materialized = 'table'}}
[0m21:25:22.348850 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.23702933, "process_user_time": 0.941043, "process_kernel_time": 0.086978, "process_mem_max_rss": "116342784", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:25:22.349197 [debug] [MainThread]: Command `dbt build` failed at 21:25:22.349124 after 0.24 seconds
[0m21:25:22.349420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109488410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a788710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1b110>]}
[0m21:25:22.349604 [debug] [MainThread]: Flushing usage events
[0m21:25:33.115079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee6360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f118e0>]}


============================== 21:25:33.117188 | cddd5e0b-535a-4fb4-97b8-1924eadb5fa7 ==============================
[0m21:25:33.117188 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:25:33.117515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build -s stg_ed_math_ugrad', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:25:33.232695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cddd5e0b-535a-4fb4-97b8-1924eadb5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109537c50>]}
[0m21:25:33.256876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cddd5e0b-535a-4fb4-97b8-1924eadb5fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fa330>]}
[0m21:25:33.257253 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:25:33.261979 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:25:33.276614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:25:33.276968 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/stg_start_ups.sql
[0m21:25:33.277181 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/staging/stg_ed_math_ugrad.sql
[0m21:25:33.325527 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_start_ups (models/staging/stg_start_ups.sql)
  unexpected '}', expected ')'
    line 1
      {{config(materialized = 'table'}}
[0m21:25:33.326443 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.23526308, "process_user_time": 0.954051, "process_kernel_time": 0.08457, "process_mem_max_rss": "115900416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:25:33.326764 [debug] [MainThread]: Command `dbt build` failed at 21:25:33.326696 after 0.24 seconds
[0m21:25:33.326983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f118e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109487200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b58d70>]}
[0m21:25:33.327164 [debug] [MainThread]: Flushing usage events
[0m21:26:13.408503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e88920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eadb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ead700>]}


============================== 21:26:13.410542 | 4dedd4d8-f385-4e02-b569-dacce7c9ca8a ==============================
[0m21:26:13.410542 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:26:13.410839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -s stg_ed_math_ugrad', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:26:13.528554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dedd4d8-f385-4e02-b569-dacce7c9ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad8890>]}
[0m21:26:13.554660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dedd4d8-f385-4e02-b569-dacce7c9ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1f200>]}
[0m21:26:13.555123 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:26:13.560199 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:26:13.574502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:13.574695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:13.577509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dedd4d8-f385-4e02-b569-dacce7c9ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9a480>]}
[0m21:26:13.582670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dedd4d8-f385-4e02-b569-dacce7c9ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108134650>]}
[0m21:26:13.582906 [info ] [MainThread]: Found 5 models, 1 source, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:26:13.583690 [info ] [MainThread]: 
[0m21:26:13.584107 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:26:13.584661 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics'
[0m21:26:13.592408 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics"
[0m21:26:13.592630 [debug] [ThreadPool]: On list_msw_data_analytics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics"} */

    select distinct nspname from pg_namespace
[0m21:26:13.592794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:13.594391 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:26:13.594562 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:26:13.876408 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:13.882822 [debug] [ThreadPool]: On list_msw_data_analytics: Close
[0m21:26:13.884804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_msw_data_analytics, now list_msw_data_analytics_dev_cgray)
[0m21:26:13.890851 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:26:13.891119 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:26:13.891350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:13.891660 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:26:13.891890 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:26:14.162267 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:14.163791 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:26:14.164636 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:26:14.247960 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:14.252427 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:26:14.315535 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:26:14.326140 [debug] [MainThread]: Using redshift connection "master"
[0m21:26:14.326507 [debug] [MainThread]: On master: BEGIN
[0m21:26:14.326783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:14.327190 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:26:14.327496 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:26:14.554620 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:14.555792 [debug] [MainThread]: Using redshift connection "master"
[0m21:26:14.556459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:26:14.697481 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:14.703032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dedd4d8-f385-4e02-b569-dacce7c9ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748c170>]}
[0m21:26:14.703753 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:14.773416 [debug] [MainThread]: Using redshift connection "master"
[0m21:26:14.774910 [debug] [MainThread]: On master: BEGIN
[0m21:26:14.802156 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:14.803341 [debug] [MainThread]: On master: COMMIT
[0m21:26:14.804495 [debug] [MainThread]: Using redshift connection "master"
[0m21:26:14.805372 [debug] [MainThread]: On master: COMMIT
[0m21:26:14.859223 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:14.860438 [debug] [MainThread]: On master: Close
[0m21:26:14.863299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:14.864100 [info ] [MainThread]: 
[0m21:26:14.867680 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:26:14.868613 [info ] [Thread-1 (]: 1 of 1 START sql table model dev_cgray.stg_ed_math_ugrad ....................... [RUN]
[0m21:26:14.869703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:26:14.870190 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:26:14.874045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:14.875152 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:26:14.870449 => 21:26:14.874910
[0m21:26:14.875551 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:26:14.911375 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:14.912449 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:14.912690 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:26:14.912893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:14.913232 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:26:14.913446 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:26:15.115340 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:15.117046 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:15.118300 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */

  
    

  create  table
    "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_tmp"
    
    
    
  as (
    

select *
from "msw_data_analytics"."dev_cgray"."career_phase"
  );
[0m21:26:28.879467 [debug] [Thread-1 (]: SQL status: SUCCESS in 14.0 seconds
[0m21:26:28.883654 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:28.884447 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:28.884870 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.031053 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.031811 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.032287 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:26:29.055026 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.063559 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad"
[0m21:26:29.069070 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.069463 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
drop view if exists "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad" cascade
[0m21:26:29.118493 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.119803 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.120363 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.120777 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.236582 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.238155 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.238755 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:26:29.260774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.271724 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.272461 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
alter table "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_tmp" rename to "stg_ed_math_ugrad"
[0m21:26:29.421902 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.445234 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.445810 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.446117 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.583412 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.584567 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.585019 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:26:29.629818 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.632630 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_backup"
[0m21:26:29.633818 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.634211 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
drop view if exists "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_backup" cascade
[0m21:26:29.682456 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.683781 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.684340 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.684735 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:26:29.850330 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.851040 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:26:29.851400 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:26:29.873006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:29.874199 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:26:14.875793 => 21:26:29.873980
[0m21:26:29.874598 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: ROLLBACK
[0m21:26:29.922569 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: Close
[0m21:26:29.923817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dedd4d8-f385-4e02-b569-dacce7c9ca8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810b200>]}
[0m21:26:29.924463 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev_cgray.stg_ed_math_ugrad .................. [[32mSUCCESS[0m in 15.05s]
[0m21:26:29.925034 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:26:29.926535 [debug] [MainThread]: Using redshift connection "master"
[0m21:26:29.926946 [debug] [MainThread]: On master: BEGIN
[0m21:26:29.927248 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:29.927713 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:26:29.928019 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:26:30.134391 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:30.135093 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.135597 [debug] [MainThread]: Using redshift connection "master"
[0m21:26:30.135946 [debug] [MainThread]: On master: COMMIT
[0m21:26:30.177970 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:26:30.178465 [debug] [MainThread]: On master: Close
[0m21:26:30.179740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:30.180133 [debug] [MainThread]: Connection 'model.dbt_meetup4.stg_ed_math_ugrad' was properly closed.
[0m21:26:30.180594 [info ] [MainThread]: 
[0m21:26:30.181069 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 16.60 seconds (16.60s).
[0m21:26:30.181980 [debug] [MainThread]: Command end result
[0m21:26:30.192618 [info ] [MainThread]: 
[0m21:26:30.193088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:30.193417 [info ] [MainThread]: 
[0m21:26:30.193764 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:26:30.195622 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 16.81215, "process_user_time": 1.247808, "process_kernel_time": 0.134256, "process_mem_max_rss": "123764736", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:30.196236 [debug] [MainThread]: Command `dbt build` succeeded at 21:26:30.196072 after 16.81 seconds
[0m21:26:30.196641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ead700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b99610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f5190>]}
[0m21:26:30.196974 [debug] [MainThread]: Flushing usage events
[0m21:27:18.703813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104774b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036db6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a1880>]}


============================== 21:27:18.706199 | ba6e51e3-289b-4df2-9f28-2d16e4257b5c ==============================
[0m21:27:18.706199 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:27:18.706498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s +exposure:career_path', 'send_anonymous_usage_stats': 'True'}
[0m21:27:18.853447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7d5b0>]}
[0m21:27:18.877036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b7c110>]}
[0m21:27:18.877526 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:27:18.881918 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:27:18.896503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:18.896718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:18.899567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bbd70>]}
[0m21:27:18.904589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056eb530>]}
[0m21:27:18.904809 [info ] [MainThread]: Found 5 models, 1 source, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:27:18.905010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cff320>]}
[0m21:27:18.905984 [info ] [MainThread]: 
[0m21:27:18.906395 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:27:18.906956 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics'
[0m21:27:18.914221 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics"
[0m21:27:18.914419 [debug] [ThreadPool]: On list_msw_data_analytics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics"} */

    select distinct nspname from pg_namespace
[0m21:27:18.914575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:18.916091 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:18.916270 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:19.337149 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:19.343157 [debug] [ThreadPool]: On list_msw_data_analytics: Close
[0m21:27:19.346022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_msw_data_analytics, now list_msw_data_analytics_dev_cgray)
[0m21:27:19.353148 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:27:19.353543 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:27:19.353802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:19.354236 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:19.354513 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:19.557716 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:19.559160 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:27:19.560246 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:27:19.641730 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:19.646392 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:27:19.709393 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:27:19.722127 [debug] [MainThread]: Using redshift connection "master"
[0m21:27:19.722642 [debug] [MainThread]: On master: BEGIN
[0m21:27:19.722970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:19.723450 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:19.723795 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:19.935775 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:19.937128 [debug] [MainThread]: Using redshift connection "master"
[0m21:27:19.938243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:27:20.064347 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.068992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a3ad0>]}
[0m21:27:20.069947 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:20.130108 [debug] [MainThread]: Using redshift connection "master"
[0m21:27:20.131598 [debug] [MainThread]: On master: BEGIN
[0m21:27:20.154300 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.155520 [debug] [MainThread]: On master: COMMIT
[0m21:27:20.156682 [debug] [MainThread]: Using redshift connection "master"
[0m21:27:20.157493 [debug] [MainThread]: On master: COMMIT
[0m21:27:20.201618 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.202942 [debug] [MainThread]: On master: Close
[0m21:27:20.204850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:20.205382 [info ] [MainThread]: 
[0m21:27:20.210527 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:27:20.211356 [info ] [Thread-1 (]: 1 of 3 START sql table model dev_cgray.stg_ed_math_ugrad ....................... [RUN]
[0m21:27:20.212300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:27:20.212723 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:27:20.216556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.217724 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:27:20.212974 => 21:27:20.217427
[0m21:27:20.218466 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:27:20.253954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.254919 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.255214 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:27:20.255435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:20.255748 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:20.255972 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:20.464060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.465688 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.466948 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */

  
    

  create  table
    "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_tmp"
    
    
    
  as (
    

select *
from "msw_data_analytics"."dev_cgray"."career_phase"
  );
[0m21:27:20.694896 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.697875 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:20.699054 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.699763 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:20.875596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.877424 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.877967 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:27:20.906961 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.925181 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad"
[0m21:27:20.930620 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.931055 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
drop table if exists "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad" cascade
[0m21:27:20.987542 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:20.989652 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:20.990286 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:20.990754 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:21.128103 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.129845 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.130948 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:27:21.155164 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.166777 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.167402 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
alter table "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_tmp" rename to "stg_ed_math_ugrad"
[0m21:27:21.338049 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.363592 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:21.364164 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.364467 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:21.513948 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.516213 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.517349 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:27:21.566638 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.573067 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_backup"
[0m21:27:21.574633 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.575065 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.stg_ed_math_ugrad"} */
drop table if exists "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad__dbt_backup" cascade
[0m21:27:21.623395 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.625796 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:21.626623 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.627160 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: COMMIT
[0m21:27:21.665265 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.666847 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:27:21.667931 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: BEGIN
[0m21:27:21.693162 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:21.696302 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:27:20.218756 => 21:27:21.695627
[0m21:27:21.697436 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: ROLLBACK
[0m21:27:21.767568 [debug] [Thread-1 (]: On model.dbt_meetup4.stg_ed_math_ugrad: Close
[0m21:27:21.770811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d32150>]}
[0m21:27:21.772500 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev_cgray.stg_ed_math_ugrad .................. [[32mSUCCESS[0m in 1.56s]
[0m21:27:21.773363 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:27:21.774617 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:27:21.775919 [info ] [Thread-1 (]: 2 of 3 START sql view model dev_cgray.int_pipeline_pilot ....................... [RUN]
[0m21:27:21.777135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:27:21.777669 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:27:21.781672 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:21.782815 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:27:21.777980 => 21:27:21.782563
[0m21:27:21.783218 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:27:21.802983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:21.803973 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:21.804254 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: BEGIN
[0m21:27:21.804499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:21.804878 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:21.805129 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:22.066674 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.068315 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.069510 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.int_pipeline_pilot"} */


  create view "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_tmp" as (
    select * from "msw_data_analytics"."dev_cgray"."stg_ed_math_ugrad"
  ) ;
[0m21:27:22.188651 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.195027 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.195627 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.int_pipeline_pilot"} */
alter table "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_tmp" rename to "int_pipeline_pilot"
[0m21:27:22.269440 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.274448 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:27:22.275332 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.275830 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:27:22.474856 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.477190 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.478315 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: BEGIN
[0m21:27:22.531424 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.536838 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_backup"
[0m21:27:22.542576 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.543220 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.int_pipeline_pilot"} */
drop view if exists "msw_data_analytics"."dev_cgray"."int_pipeline_pilot__dbt_backup" cascade
[0m21:27:22.597914 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.601055 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:27:22.601942 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.602359 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: COMMIT
[0m21:27:22.748944 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.750719 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.int_pipeline_pilot"
[0m21:27:22.751818 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: BEGIN
[0m21:27:22.780363 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:22.783577 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:27:21.783459 => 21:27:22.782932
[0m21:27:22.784722 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: ROLLBACK
[0m21:27:22.855909 [debug] [Thread-1 (]: On model.dbt_meetup4.int_pipeline_pilot: Close
[0m21:27:22.859340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d78f0>]}
[0m21:27:22.861133 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dev_cgray.int_pipeline_pilot .................. [[32mSUCCESS[0m in 1.08s]
[0m21:27:22.862149 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:27:22.863315 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:27:22.864308 [info ] [Thread-1 (]: 3 of 3 START sql view model dev_cgray.bioinformatics ........................... [RUN]
[0m21:27:22.865213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:27:22.865539 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:27:22.868011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:27:22.868826 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:27:22.865711 => 21:27:22.868667
[0m21:27:22.869082 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:27:22.872225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.bioinformatics"
[0m21:27:22.872977 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:22.873227 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: BEGIN
[0m21:27:22.873438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:22.873772 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:22.874008 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:23.099864 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.100247 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.100493 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.bioinformatics"} */


  create view "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_tmp" as (
    select * from "msw_data_analytics"."dev_cgray"."int_pipeline_pilot"
  ) ;
[0m21:27:23.207928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.216130 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.216592 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.bioinformatics"} */
alter table "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_tmp" rename to "bioinformatics"
[0m21:27:23.309716 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.314980 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:27:23.315912 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.316424 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:27:23.486157 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.488386 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.489331 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: BEGIN
[0m21:27:23.547466 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.554400 [debug] [Thread-1 (]: Applying DROP to: "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_backup"
[0m21:27:23.556554 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.557034 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.bioinformatics"} */
drop view if exists "msw_data_analytics"."dev_cgray"."bioinformatics__dbt_backup" cascade
[0m21:27:23.611293 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.613503 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:27:23.614315 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.614854 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: COMMIT
[0m21:27:23.759813 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.761535 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.bioinformatics"
[0m21:27:23.762477 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: BEGIN
[0m21:27:23.791112 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:23.794136 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:27:22.869244 => 21:27:23.793496
[0m21:27:23.795240 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: ROLLBACK
[0m21:27:23.844793 [debug] [Thread-1 (]: On model.dbt_meetup4.bioinformatics: Close
[0m21:27:23.847571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6e51e3-289b-4df2-9f28-2d16e4257b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f25550>]}
[0m21:27:23.848653 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dev_cgray.bioinformatics ...................... [[32mSUCCESS[0m in 0.98s]
[0m21:27:23.849546 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:27:23.851558 [debug] [MainThread]: Using redshift connection "master"
[0m21:27:23.851942 [debug] [MainThread]: On master: BEGIN
[0m21:27:23.852283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:23.852912 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:27:23.853851 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:27:24.083442 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:24.084481 [debug] [MainThread]: On master: COMMIT
[0m21:27:24.085188 [debug] [MainThread]: Using redshift connection "master"
[0m21:27:24.085590 [debug] [MainThread]: On master: COMMIT
[0m21:27:24.134957 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:27:24.135851 [debug] [MainThread]: On master: Close
[0m21:27:24.137402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:24.137877 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:27:24.138376 [info ] [MainThread]: 
[0m21:27:24.138866 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m21:27:24.140056 [debug] [MainThread]: Command end result
[0m21:27:24.152607 [info ] [MainThread]: 
[0m21:27:24.153112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:27:24.153419 [info ] [MainThread]: 
[0m21:27:24.153753 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:27:24.156099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4771843, "process_user_time": 1.456447, "process_kernel_time": 0.168254, "process_mem_max_rss": "126861312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:24.156856 [debug] [MainThread]: Command `dbt run` succeeded at 21:27:24.156723 after 5.48 seconds
[0m21:27:24.157287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c9640>]}
[0m21:27:24.157674 [debug] [MainThread]: Flushing usage events
[0m21:29:33.389557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a181190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109436e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ad9a0>]}


============================== 21:29:33.391753 | a4eb2400-32c7-45a8-a725-c7b5923ad3ea ==============================
[0m21:29:33.391753 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:29:33.392070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:33.508541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4eb2400-32c7-45a8-a725-c7b5923ad3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109475520>]}
[0m21:29:33.532536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4eb2400-32c7-45a8-a725-c7b5923ad3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8fc50>]}
[0m21:29:33.532894 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:29:33.537254 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:29:33.552173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:33.552424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:33.555471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4eb2400-32c7-45a8-a725-c7b5923ad3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b143500>]}
[0m21:29:33.556931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4eb2400-32c7-45a8-a725-c7b5923ad3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1d09e0>]}
[0m21:29:33.557180 [info ] [MainThread]: Found 5 models, 3 sources, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:29:33.557371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4eb2400-32c7-45a8-a725-c7b5923ad3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9202f0>]}
[0m21:29:33.558332 [info ] [MainThread]: 
[0m21:29:33.558746 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:29:33.559366 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:29:33.567259 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:29:33.567471 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:29:33.567630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:33.569280 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:29:33.569484 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:29:33.867193 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:33.868818 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:29:33.870006 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:29:33.955322 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:33.960608 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:29:34.016311 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:29:34.027916 [debug] [MainThread]: Using redshift connection "master"
[0m21:29:34.028287 [debug] [MainThread]: On master: BEGIN
[0m21:29:34.028576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:34.029011 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:29:34.029301 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:29:34.249028 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:34.250429 [debug] [MainThread]: Using redshift connection "master"
[0m21:29:34.251556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:29:34.454392 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:34.459281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4eb2400-32c7-45a8-a725-c7b5923ad3ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d67b0>]}
[0m21:29:34.460252 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:34.518910 [debug] [MainThread]: On master: Close
[0m21:29:34.521736 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:34.522399 [info ] [MainThread]: 
[0m21:29:34.525383 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:29:34.526783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:29:34.527561 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:29:34.531111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:29:34.532209 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:29:34.527937 => 21:29:34.531917
[0m21:29:34.532656 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:29:34.533326 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:29:34.533157 => 21:29:34.533172
[0m21:29:34.533949 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:29:34.534222 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:29:34.534988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:29:34.535833 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:29:34.539374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:29:34.540147 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:29:34.536242 => 21:29:34.539924
[0m21:29:34.540410 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:29:34.540685 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:29:34.540547 => 21:29:34.540559
[0m21:29:34.541273 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:29:34.541537 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:29:34.542039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:29:34.542414 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:29:34.545004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:29:34.545612 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:29:34.542638 => 21:29:34.545460
[0m21:29:34.545826 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:29:34.546094 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:29:34.545961 => 21:29:34.545966
[0m21:29:34.546797 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:29:34.547108 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:29:34.547672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_start_ups, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:29:34.547936 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:29:34.549951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:29:34.550453 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:29:34.548092 => 21:29:34.550304
[0m21:29:34.550713 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:29:34.551026 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:29:34.550881 => 21:29:34.550886
[0m21:29:34.551712 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:29:34.552219 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.bioinformatics
[0m21:29:34.552831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.bioinformatics)
[0m21:29:34.553153 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.bioinformatics
[0m21:29:34.555116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.bioinformatics"
[0m21:29:34.555651 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (compile): 21:29:34.553312 => 21:29:34.555495
[0m21:29:34.555914 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.bioinformatics
[0m21:29:34.556207 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.bioinformatics (execute): 21:29:34.556070 => 21:29:34.556075
[0m21:29:34.556832 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.bioinformatics
[0m21:29:34.557419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:34.557632 [debug] [MainThread]: Connection 'model.dbt_meetup4.bioinformatics' was properly closed.
[0m21:29:34.558333 [debug] [MainThread]: Command end result
[0m21:29:34.565927 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:29:34.566156 [info ] [MainThread]: Building catalog
[0m21:29:34.568001 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:29:34.580782 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:29:34.581046 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:29:34.581237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:34.581604 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:29:34.581784 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:29:34.809764 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:34.811232 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:29:34.812338 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:29:35.044993 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:35.055145 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:29:35.055759 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:29:35.132815 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:29:35.147037 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:29:35.147761 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:29:36.070727 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:29:36.100918 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:29:36.151918 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:29:36.239363 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:29:36.240272 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.8745744, "process_user_time": 1.217039, "process_kernel_time": 0.124704, "process_mem_max_rss": "122814464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:29:36.240605 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:29:36.240543 after 2.87 seconds
[0m21:29:36.240773 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:29:36.240906 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:29:36.241063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b143800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a182c60>]}
[0m21:29:36.241240 [debug] [MainThread]: Flushing usage events
[0m21:29:40.074545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a9760>]}


============================== 21:29:40.076548 | 28fed360-9494-473f-bbbb-19829381904d ==============================
[0m21:29:40.076548 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:29:40.076872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:40.187822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28fed360-9494-473f-bbbb-19829381904d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e68290>]}
[0m21:29:40.211314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28fed360-9494-473f-bbbb-19829381904d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106359850>]}
[0m21:29:40.354774 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:29:40.359636 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:29:40.361946 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.31087276, "process_user_time": 0.890651, "process_kernel_time": 0.084817, "process_mem_max_rss": "112345088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:29:40.362462 [debug] [MainThread]: Command `dbt docs serve` failed at 21:29:40.362369 after 0.31 seconds
[0m21:29:40.362782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619c440>]}
[0m21:29:40.363058 [debug] [MainThread]: Flushing usage events
[0m21:30:35.420605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a80980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aadb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aad790>]}


============================== 21:30:35.422607 | cbd64437-207d-4f43-8da2-b31c77a9bcdd ==============================
[0m21:30:35.422607 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:30:35.422903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:30:35.535884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbd64437-207d-4f43-8da2-b31c77a9bcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a59790>]}
[0m21:30:35.559540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbd64437-207d-4f43-8da2-b31c77a9bcdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bdb200>]}
[0m21:30:35.692424 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:30:35.694789 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:30:35.697247 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.3021355, "process_user_time": 0.887726, "process_kernel_time": 0.085582, "process_mem_max_rss": "112869376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:35.697941 [debug] [MainThread]: Command `dbt docs serve` failed at 21:30:35.697836 after 0.30 seconds
[0m21:30:35.698257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aad790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d96fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b235c0>]}
[0m21:30:35.698636 [debug] [MainThread]: Flushing usage events
[0m21:30:46.647362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c28950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c51af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c51670>]}


============================== 21:30:46.649423 | d3bacc78-b525-4f17-ba39-7489280bdb0a ==============================
[0m21:30:46.649423 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:30:46.649732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m21:30:46.765629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3bacc78-b525-4f17-ba39-7489280bdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109276510>]}
[0m21:30:46.789270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3bacc78-b525-4f17-ba39-7489280bdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c53950>]}
[0m21:30:46.789610 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:30:46.795250 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:30:46.813541 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m21:30:46.813853 [debug] [MainThread]: Partial parsing: deleted file: dbt_meetup4://models/marts/bioinformatics.sql
[0m21:30:46.819625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3bacc78-b525-4f17-ba39-7489280bdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c1880>]}
[0m21:30:46.820903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3bacc78-b525-4f17-ba39-7489280bdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b98200>]}
[0m21:30:46.821117 [info ] [MainThread]: Found 4 models, 3 sources, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:30:46.821281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3bacc78-b525-4f17-ba39-7489280bdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c78ce0>]}
[0m21:30:46.822142 [info ] [MainThread]: 
[0m21:30:46.822524 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:30:46.823144 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:30:46.831021 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:30:46.831212 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:30:46.831359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:46.832966 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:30:46.833149 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:30:47.105714 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:47.107273 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:30:47.108412 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:30:47.193099 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:47.197472 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:30:47.253401 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:30:47.267173 [debug] [MainThread]: Using redshift connection "master"
[0m21:30:47.267649 [debug] [MainThread]: On master: BEGIN
[0m21:30:47.267934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:47.268410 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:30:47.268718 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:30:47.490602 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:47.492089 [debug] [MainThread]: Using redshift connection "master"
[0m21:30:47.493238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:30:47.621069 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:47.628020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3bacc78-b525-4f17-ba39-7489280bdb0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10905e7b0>]}
[0m21:30:47.628725 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:47.688057 [debug] [MainThread]: On master: Close
[0m21:30:47.690563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:47.691188 [info ] [MainThread]: 
[0m21:30:47.694623 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:30:47.695521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:30:47.696649 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:30:47.701496 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:30:47.702778 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:30:47.697256 => 21:30:47.702481
[0m21:30:47.703607 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:30:47.704242 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:30:47.703987 => 21:30:47.704010
[0m21:30:47.705352 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:30:47.705769 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:30:47.706521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:30:47.707067 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:30:47.710366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:30:47.711167 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:30:47.707483 => 21:30:47.710958
[0m21:30:47.711520 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:30:47.711908 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:30:47.711730 => 21:30:47.711740
[0m21:30:47.712787 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:30:47.713149 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:30:47.713761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:30:47.714035 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:30:47.716291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:30:47.716867 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:30:47.714208 => 21:30:47.716709
[0m21:30:47.717140 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:30:47.717461 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:30:47.717311 => 21:30:47.717318
[0m21:30:47.718126 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:30:47.718430 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:30:47.718964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_start_ups, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:30:47.719256 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:30:47.721408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:30:47.721885 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:30:47.719422 => 21:30:47.721748
[0m21:30:47.722126 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:30:47.722437 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:30:47.722279 => 21:30:47.722284
[0m21:30:47.723036 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:30:47.723675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:47.723923 [debug] [MainThread]: Connection 'model.dbt_meetup4.int_pipeline_pilot' was properly closed.
[0m21:30:47.724601 [debug] [MainThread]: Command end result
[0m21:30:47.733047 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:30:47.733331 [info ] [MainThread]: Building catalog
[0m21:30:47.735014 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:30:47.747189 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:30:47.747437 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:30:47.747629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:47.747888 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:30:47.748063 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:30:47.961918 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:47.962372 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:30:47.962810 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:30:48.194063 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:48.204112 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:30:48.204709 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:30:48.282364 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:30:48.297386 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:30:48.298217 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:30:49.284715 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:30:49.314849 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:30:49.362890 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:30:49.451308 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:30:49.452206 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.8296025, "process_user_time": 1.23448, "process_kernel_time": 0.117635, "process_mem_max_rss": "122159104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:49.452526 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:30:49.452466 after 2.83 seconds
[0m21:30:49.452691 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:30:49.452821 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:30:49.452971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108acedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109093260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088992e0>]}
[0m21:30:49.453146 [debug] [MainThread]: Flushing usage events
[0m21:30:53.190622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d56d0>]}


============================== 21:30:53.192915 | 38e2cf5c-1179-431f-a6f3-4c12964d2d99 ==============================
[0m21:30:53.192915 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:30:53.193224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:30:53.311031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e2cf5c-1179-431f-a6f3-4c12964d2d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065873e0>]}
[0m21:30:53.336110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38e2cf5c-1179-431f-a6f3-4c12964d2d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a65760>]}
[0m21:30:53.448062 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:30:53.450859 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:30:53.452462 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.28641462, "process_user_time": 0.898776, "process_kernel_time": 0.085664, "process_mem_max_rss": "113229824", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:30:53.452964 [debug] [MainThread]: Command `dbt docs serve` failed at 21:30:53.452877 after 0.29 seconds
[0m21:30:53.453339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ed250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d7dd0>]}
[0m21:30:53.453607 [debug] [MainThread]: Flushing usage events
[0m21:31:48.782137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104544830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456da00>]}


============================== 21:31:48.785124 | 0a9b71ca-c5a4-46d7-b917-ba801f91a291 ==============================
[0m21:31:48.785124 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:31:48.785449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:48.927391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9b71ca-c5a4-46d7-b917-ba801f91a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104699730>]}
[0m21:31:48.951142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a9b71ca-c5a4-46d7-b917-ba801f91a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae4470>]}
[0m21:31:48.951781 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:31:48.956149 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:31:48.971283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:31:48.971484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:31:48.974232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a9b71ca-c5a4-46d7-b917-ba801f91a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548cce0>]}
[0m21:31:48.975458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a9b71ca-c5a4-46d7-b917-ba801f91a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054cb320>]}
[0m21:31:48.975655 [info ] [MainThread]: Found 4 models, 3 sources, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:31:48.975849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9b71ca-c5a4-46d7-b917-ba801f91a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10456fcb0>]}
[0m21:31:48.976759 [info ] [MainThread]: 
[0m21:31:48.977159 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:31:48.977739 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:31:48.985446 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:31:48.985704 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:31:48.985854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:48.987449 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:31:48.987654 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:31:49.393186 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:49.394862 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:31:49.395969 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:31:49.547826 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:49.553276 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:31:49.648977 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:31:49.667007 [debug] [MainThread]: Using redshift connection "master"
[0m21:31:49.667591 [debug] [MainThread]: On master: BEGIN
[0m21:31:49.667934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:49.668412 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:31:49.668709 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:31:49.888804 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:49.890243 [debug] [MainThread]: Using redshift connection "master"
[0m21:31:49.891400 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:31:50.015258 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:50.019569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9b71ca-c5a4-46d7-b917-ba801f91a291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501e510>]}
[0m21:31:50.020350 [debug] [MainThread]: On master: ROLLBACK
[0m21:31:50.081351 [debug] [MainThread]: On master: Close
[0m21:31:50.084663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:31:50.085325 [info ] [MainThread]: 
[0m21:31:50.089526 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:31:50.090837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:31:50.091376 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:31:50.095497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:31:50.096702 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:31:50.091749 => 21:31:50.096422
[0m21:31:50.097147 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:31:50.097649 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:31:50.097403 => 21:31:50.097421
[0m21:31:50.099125 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:31:50.099765 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:31:50.100686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.stg_ed_math_ugrad)
[0m21:31:50.101050 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:31:50.104042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_math_ugrad"
[0m21:31:50.104820 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (compile): 21:31:50.101251 => 21:31:50.104615
[0m21:31:50.105186 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:31:50.105588 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_math_ugrad (execute): 21:31:50.105407 => 21:31:50.105416
[0m21:31:50.106416 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_math_ugrad
[0m21:31:50.106781 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:31:50.107419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_math_ugrad, now model.dbt_meetup4.stg_ed_statistics_phd)
[0m21:31:50.107775 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:31:50.110162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_ed_statistics_phd"
[0m21:31:50.110741 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (compile): 21:31:50.107974 => 21:31:50.110570
[0m21:31:50.111041 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:31:50.111385 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_ed_statistics_phd (execute): 21:31:50.111229 => 21:31:50.111235
[0m21:31:50.112067 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_ed_statistics_phd
[0m21:31:50.112364 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.stg_start_ups
[0m21:31:50.112997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.stg_ed_statistics_phd, now model.dbt_meetup4.stg_start_ups)
[0m21:31:50.113274 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.stg_start_ups
[0m21:31:50.115461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.stg_start_ups"
[0m21:31:50.115956 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (compile): 21:31:50.113443 => 21:31:50.115799
[0m21:31:50.116224 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.stg_start_ups
[0m21:31:50.116501 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.stg_start_ups (execute): 21:31:50.116370 => 21:31:50.116375
[0m21:31:50.117084 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.stg_start_ups
[0m21:31:50.117745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:50.118003 [debug] [MainThread]: Connection 'model.dbt_meetup4.stg_start_ups' was properly closed.
[0m21:31:50.118657 [debug] [MainThread]: Command end result
[0m21:31:50.125912 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:31:50.126122 [info ] [MainThread]: Building catalog
[0m21:31:50.127842 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:31:50.141303 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:31:50.141592 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:31:50.141773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:50.142041 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:31:50.142234 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:31:50.343418 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:50.344206 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:31:50.344914 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:31:50.573521 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:50.583913 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:31:50.584525 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:31:50.658688 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:31:50.672099 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:31:50.672688 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:31:51.544304 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:31:51.573546 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:31:51.618637 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:31:51.704672 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:31:51.705992 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.9521377, "process_user_time": 1.244451, "process_kernel_time": 0.136598, "process_mem_max_rss": "123125760", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:51.706340 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:31:51.706276 after 2.95 seconds
[0m21:31:51.706519 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:31:51.706661 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:31:51.706822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104201fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb5040>]}
[0m21:31:51.707000 [debug] [MainThread]: Flushing usage events
[0m21:31:54.430051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e9550>]}


============================== 21:31:54.432170 | 06b03fce-cab4-4c07-993f-e33a9cccdb37 ==============================
[0m21:31:54.432170 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:31:54.432482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m21:31:54.549354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06b03fce-cab4-4c07-993f-e33a9cccdb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd2f00>]}
[0m21:31:54.574101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06b03fce-cab4-4c07-993f-e33a9cccdb37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a8d0>]}
[0m21:31:54.711053 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:31:54.714299 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:31:54.715852 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.31001696, "process_user_time": 0.90663, "process_kernel_time": 0.086299, "process_mem_max_rss": "112640000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:54.716341 [debug] [MainThread]: Command `dbt docs serve` failed at 21:31:54.716256 after 0.31 seconds
[0m21:31:54.716619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d93c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107222cc0>]}
[0m21:31:54.716863 [debug] [MainThread]: Flushing usage events
[0m21:33:23.067566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110180200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101adc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ad880>]}


============================== 21:33:23.069519 | 1c1986e3-7f90-4732-bb68-80213fe47921 ==============================
[0m21:33:23.069519 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:33:23.069818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m21:33:23.185087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c1986e3-7f90-4732-bb68-80213fe47921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110560dd0>]}
[0m21:33:23.209534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c1986e3-7f90-4732-bb68-80213fe47921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110004a40>]}
[0m21:33:23.210102 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:33:23.214818 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:33:23.229616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:33:23.229818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:33:23.232550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c1986e3-7f90-4732-bb68-80213fe47921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dd4170>]}
[0m21:33:23.233753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c1986e3-7f90-4732-bb68-80213fe47921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130ae10>]}
[0m21:33:23.233972 [info ] [MainThread]: Found 2 models, 3 sources, 1 exposure, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:33:23.234164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1986e3-7f90-4732-bb68-80213fe47921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110da5ca0>]}
[0m21:33:23.235010 [info ] [MainThread]: 
[0m21:33:23.235407 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:33:23.235924 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:33:23.243468 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:33:23.243659 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:33:23.243804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:23.245323 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:33:23.245521 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:33:23.528720 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:23.530291 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:33:23.531444 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:33:23.612837 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:23.618246 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:33:23.687422 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:33:23.704003 [debug] [MainThread]: Using redshift connection "master"
[0m21:33:23.704523 [debug] [MainThread]: On master: BEGIN
[0m21:33:23.704778 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:33:23.705171 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:33:23.705445 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:33:23.941837 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:23.943273 [debug] [MainThread]: Using redshift connection "master"
[0m21:33:23.944098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:33:24.074013 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:24.079461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c1986e3-7f90-4732-bb68-80213fe47921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104729c0>]}
[0m21:33:24.080275 [debug] [MainThread]: On master: ROLLBACK
[0m21:33:24.149925 [debug] [MainThread]: On master: Close
[0m21:33:24.152757 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:33:24.153355 [info ] [MainThread]: 
[0m21:33:24.158447 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:33:24.159721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:33:24.160248 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:33:24.163918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:33:24.165465 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:33:24.160582 => 21:33:24.164983
[0m21:33:24.166055 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:33:24.166539 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:33:24.166320 => 21:33:24.166340
[0m21:33:24.167600 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:33:24.168417 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_R_language
[0m21:33:24.169321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.int_R_language)
[0m21:33:24.169755 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_R_language
[0m21:33:24.172535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_R_language"
[0m21:33:24.173389 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_R_language (compile): 21:33:24.169995 => 21:33:24.173156
[0m21:33:24.173738 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_R_language
[0m21:33:24.174134 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_R_language (execute): 21:33:24.173951 => 21:33:24.173962
[0m21:33:24.174940 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_R_language
[0m21:33:24.175633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:24.175875 [debug] [MainThread]: Connection 'model.dbt_meetup4.int_R_language' was properly closed.
[0m21:33:24.176463 [debug] [MainThread]: Command end result
[0m21:33:24.183335 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:33:24.183622 [info ] [MainThread]: Building catalog
[0m21:33:24.185457 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:33:24.199832 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:33:24.200125 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:33:24.200334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:24.200640 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:33:24.200853 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:33:24.434471 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:24.436151 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:33:24.437600 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:33:24.662737 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:24.672289 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:33:24.672887 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:33:24.749102 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:33:24.767648 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:33:24.768468 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:33:25.752977 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:33:25.781897 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:33:25.826619 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:33:25.913281 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:33:25.914215 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.8727584, "process_user_time": 1.215193, "process_kernel_time": 0.127017, "process_mem_max_rss": "123289600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:25.914590 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:33:25.914510 after 2.87 seconds
[0m21:33:25.914761 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:33:25.914896 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:33:25.915051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad21e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11015bfb0>]}
[0m21:33:25.915227 [debug] [MainThread]: Flushing usage events
[0m21:33:28.766651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bdd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e9700>]}


============================== 21:33:28.769045 | cf9cd766-2c43-41a9-8c6e-755afd6d80d5 ==============================
[0m21:33:28.769045 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:33:28.769373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m21:33:28.886298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf9cd766-2c43-41a9-8c6e-755afd6d80d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f98a10>]}
[0m21:33:28.910638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf9cd766-2c43-41a9-8c6e-755afd6d80d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090eb9b0>]}
[0m21:33:29.038919 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:33:29.041697 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:33:29.043274 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.30390617, "process_user_time": 0.909437, "process_kernel_time": 0.085998, "process_mem_max_rss": "113491968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:29.043767 [debug] [MainThread]: Command `dbt docs serve` failed at 21:33:29.043684 after 0.30 seconds
[0m21:33:29.044046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da5580>]}
[0m21:33:29.044308 [debug] [MainThread]: Flushing usage events
[0m21:35:49.525390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106596240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c5820>]}


============================== 21:35:49.527414 | d35a050b-2c90-4554-9ed8-a19372d176d5 ==============================
[0m21:35:49.527414 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:35:49.527732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m21:35:49.645885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd35a050b-2c90-4554-9ed8-a19372d176d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703f3e0>]}
[0m21:35:49.671664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd35a050b-2c90-4554-9ed8-a19372d176d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106597e90>]}
[0m21:35:49.800899 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:35:49.804010 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:35:49.805972 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.3056122, "process_user_time": 0.895641, "process_kernel_time": 0.095728, "process_mem_max_rss": "112869376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:49.806629 [debug] [MainThread]: Command `dbt docs serve` failed at 21:35:49.806515 after 0.31 seconds
[0m21:35:49.806978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106596240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e19a0>]}
[0m21:35:49.807255 [debug] [MainThread]: Flushing usage events
[0m21:37:40.224214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106980680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ad820>]}


============================== 21:37:40.226349 | 19458993-b87d-453d-b52d-005871866c6f ==============================
[0m21:37:40.226349 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:37:40.226682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:40.341959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19458993-b87d-453d-b52d-005871866c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e11b50>]}
[0m21:37:40.365825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19458993-b87d-453d-b52d-005871866c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d4c50>]}
[0m21:37:40.367178 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:37:40.371661 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:37:40.386497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:40.386701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:40.389587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19458993-b87d-453d-b52d-005871866c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760f890>]}
[0m21:37:40.390873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19458993-b87d-453d-b52d-005871866c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0af00>]}
[0m21:37:40.391079 [info ] [MainThread]: Found 2 models, 3 sources, 2 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:37:40.391266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19458993-b87d-453d-b52d-005871866c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069818e0>]}
[0m21:37:40.392122 [info ] [MainThread]: 
[0m21:37:40.392504 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:37:40.393054 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:37:40.400772 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:37:40.400958 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:37:40.401104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:40.402709 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:37:40.402911 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:37:40.700295 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:37:40.701863 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:37:40.703002 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:37:40.796551 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:37:40.801134 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:37:40.858679 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:37:40.876236 [debug] [MainThread]: Using redshift connection "master"
[0m21:37:40.876717 [debug] [MainThread]: On master: BEGIN
[0m21:37:40.877082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:40.877603 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:37:40.877918 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:37:41.691990 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m21:37:41.693689 [debug] [MainThread]: Using redshift connection "master"
[0m21:37:41.694862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:37:41.820606 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:37:41.826246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19458993-b87d-453d-b52d-005871866c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c72b70>]}
[0m21:37:41.826956 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:41.886997 [debug] [MainThread]: On master: Close
[0m21:37:41.890111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:41.891196 [info ] [MainThread]: 
[0m21:37:41.895854 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_pipeline_pilot
[0m21:37:41.896874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.int_pipeline_pilot)
[0m21:37:41.897783 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_pipeline_pilot
[0m21:37:41.902613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_pipeline_pilot"
[0m21:37:41.903983 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (compile): 21:37:41.898447 => 21:37:41.903597
[0m21:37:41.904504 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_pipeline_pilot
[0m21:37:41.905088 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_pipeline_pilot (execute): 21:37:41.904835 => 21:37:41.904855
[0m21:37:41.906139 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_pipeline_pilot
[0m21:37:41.906906 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.int_R_language
[0m21:37:41.907753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.int_pipeline_pilot, now model.dbt_meetup4.int_R_language)
[0m21:37:41.908192 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.int_R_language
[0m21:37:41.911140 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.int_R_language"
[0m21:37:41.911890 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_R_language (compile): 21:37:41.908419 => 21:37:41.911693
[0m21:37:41.912221 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.int_R_language
[0m21:37:41.912596 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.int_R_language (execute): 21:37:41.912420 => 21:37:41.912428
[0m21:37:41.913419 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.int_R_language
[0m21:37:41.914372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:41.914674 [debug] [MainThread]: Connection 'model.dbt_meetup4.int_R_language' was properly closed.
[0m21:37:41.915346 [debug] [MainThread]: Command end result
[0m21:37:41.922103 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:37:41.922372 [info ] [MainThread]: Building catalog
[0m21:37:41.924087 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:37:41.938366 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:37:41.938644 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:37:41.938846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:41.939124 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:37:41.939324 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:37:42.139687 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:37:42.140271 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:37:42.140830 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:37:42.373379 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:37:42.387476 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:37:42.388067 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:37:42.467151 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:37:42.481547 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:37:42.482352 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:37:43.381115 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:37:43.407657 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:37:43.466389 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:37:43.553320 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:37:43.554271 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.3540664, "process_user_time": 1.233851, "process_kernel_time": 0.129099, "process_mem_max_rss": "123535360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:37:43.554611 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:37:43.554549 after 3.35 seconds
[0m21:37:43.554786 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:37:43.554922 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:37:43.555074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767f0e0>]}
[0m21:37:43.555254 [debug] [MainThread]: Flushing usage events
[0m21:37:46.154511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ba4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e95e0>]}


============================== 21:37:46.156647 | 8b61ba09-3e91-4bab-bfef-5cdf76a3cd74 ==============================
[0m21:37:46.156647 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:37:46.156961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:46.274652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b61ba09-3e91-4bab-bfef-5cdf76a3cd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063128d0>]}
[0m21:37:46.301355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b61ba09-3e91-4bab-bfef-5cdf76a3cd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ebda0>]}
[0m21:37:46.415085 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:37:46.418382 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:37:46.419931 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.29037824, "process_user_time": 0.904973, "process_kernel_time": 0.084049, "process_mem_max_rss": "114442240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:37:46.420479 [debug] [MainThread]: Command `dbt docs serve` failed at 21:37:46.420399 after 0.29 seconds
[0m21:37:46.420742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106512c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef4f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d19d0>]}
[0m21:37:46.420986 [debug] [MainThread]: Flushing usage events
[0m21:39:46.535052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b819d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bad8b0>]}


============================== 21:39:46.537204 | c35540b0-ea67-481e-a586-dba64d4adb5c ==============================
[0m21:39:46.537204 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:39:46.537502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:46.651922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c35540b0-ea67-481e-a586-dba64d4adb5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056dd2b0>]}
[0m21:39:46.676547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c35540b0-ea67-481e-a586-dba64d4adb5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb9880>]}
[0m21:39:46.676978 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:39:46.681684 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:39:46.696509 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m21:39:46.696822 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/intermediate/pipeline_pilot.sql
[0m21:39:46.696995 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://models/intermediate/R_language.sql
[0m21:39:46.697205 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/exposures/career_path.yml
[0m21:39:46.697356 [debug] [MainThread]: Partial parsing: deleted file: dbt_meetup4://models/intermediate/int_pipeline_pilot.sql
[0m21:39:46.697499 [debug] [MainThread]: Partial parsing: deleted file: dbt_meetup4://models/intermediate/int_R_language.sql
[0m21:39:46.765260 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_meetup4.R_language' (models/intermediate/R_language.sql) depends on a node named 'int_pipeline_pilot' which was not found
[0m21:39:46.766149 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.25491595, "process_user_time": 0.972731, "process_kernel_time": 0.094686, "process_mem_max_rss": "117686272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:46.766506 [debug] [MainThread]: Command `dbt docs generate` failed at 21:39:46.766436 after 0.26 seconds
[0m21:39:46.766715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c76b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106762060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061df710>]}
[0m21:39:46.766898 [debug] [MainThread]: Flushing usage events
[0m21:39:57.896605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104759ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104759b80>]}


============================== 21:39:57.898665 | 2740f25f-744c-4f14-aabe-6f39ad6074b6 ==============================
[0m21:39:57.898665 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:39:57.898980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m21:39:58.015239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2740f25f-744c-4f14-aabe-6f39ad6074b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cf680>]}
[0m21:39:58.040622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2740f25f-744c-4f14-aabe-6f39ad6074b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105199a30>]}
[0m21:39:58.041122 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:39:58.045778 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:39:58.060119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:58.060416 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:58.063172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2740f25f-744c-4f14-aabe-6f39ad6074b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105243c50>]}
[0m21:39:58.064394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2740f25f-744c-4f14-aabe-6f39ad6074b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569c110>]}
[0m21:39:58.064601 [info ] [MainThread]: Found 2 models, 3 sources, 2 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:39:58.064802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2740f25f-744c-4f14-aabe-6f39ad6074b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8f860>]}
[0m21:39:58.065644 [info ] [MainThread]: 
[0m21:39:58.066045 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:39:58.066633 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:39:58.074191 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:39:58.074374 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:39:58.074523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:58.076138 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:39:58.076343 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:39:58.369580 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:58.371066 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:39:58.371941 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:39:58.457903 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:58.461417 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:39:58.514685 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:39:58.531021 [debug] [MainThread]: Using redshift connection "master"
[0m21:39:58.531645 [debug] [MainThread]: On master: BEGIN
[0m21:39:58.531950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:39:58.532399 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:39:58.532707 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:39:58.772554 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:58.774006 [debug] [MainThread]: Using redshift connection "master"
[0m21:39:58.774797 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:39:58.939267 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:58.945270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2740f25f-744c-4f14-aabe-6f39ad6074b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104706510>]}
[0m21:39:58.945933 [debug] [MainThread]: On master: ROLLBACK
[0m21:39:59.076291 [debug] [MainThread]: On master: Close
[0m21:39:59.079691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:59.080519 [info ] [MainThread]: 
[0m21:39:59.084228 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.pipeline_pilot
[0m21:39:59.085547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.pipeline_pilot)
[0m21:39:59.086071 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.pipeline_pilot
[0m21:39:59.090285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.pipeline_pilot"
[0m21:39:59.091485 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (compile): 21:39:59.086552 => 21:39:59.091212
[0m21:39:59.091931 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.pipeline_pilot
[0m21:39:59.092487 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (execute): 21:39:59.092238 => 21:39:59.092258
[0m21:39:59.093656 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.pipeline_pilot
[0m21:39:59.094443 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m21:39:59.095194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.pipeline_pilot, now model.dbt_meetup4.R_language)
[0m21:39:59.095571 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m21:39:59.098471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m21:39:59.099188 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 21:39:59.095806 => 21:39:59.099006
[0m21:39:59.099501 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m21:39:59.099858 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 21:39:59.099689 => 21:39:59.099696
[0m21:39:59.100634 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m21:39:59.101362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:59.101641 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_language' was properly closed.
[0m21:39:59.102214 [debug] [MainThread]: Command end result
[0m21:39:59.108897 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:39:59.109169 [info ] [MainThread]: Building catalog
[0m21:39:59.110815 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:39:59.125026 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:39:59.125318 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:39:59.125512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:59.125811 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:39:59.126012 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:39:59.390206 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:59.391868 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:39:59.393274 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:39:59.645491 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:59.658875 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:39:59.659457 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:39:59.737296 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:39:59.752443 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:39:59.753203 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:40:00.709690 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:40:00.752223 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:40:00.807476 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:40:00.903191 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:40:00.904243 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.0324316, "process_user_time": 1.277772, "process_kernel_time": 0.123508, "process_mem_max_rss": "123404288", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:40:00.904585 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:40:00.904522 after 3.03 seconds
[0m21:40:00.904758 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:40:00.904893 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:40:00.905053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104706660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105677e00>]}
[0m21:40:00.905222 [debug] [MainThread]: Flushing usage events
[0m21:40:05.184648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067924e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c1c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c18b0>]}


============================== 21:40:05.186839 | 6fd91d64-1568-46ae-a4ca-c654761f4550 ==============================
[0m21:40:05.186839 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:40:05.187147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:40:05.306622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fd91d64-1568-46ae-a4ca-c654761f4550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc6030>]}
[0m21:40:05.331635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fd91d64-1568-46ae-a4ca-c654761f4550', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682d340>]}
[0m21:40:05.466915 [error] [MainThread]: Encountered an error:
[Errno 48] Address already in use
[0m21:40:05.469374 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Users/charles/Documents/dbt_meetup4/.venv/lib/python3.12/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/homebrew/Cellar/python@3.12/3.12.3/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use

[0m21:40:05.470672 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 0.31083775, "process_user_time": 0.899085, "process_kernel_time": 0.086817, "process_mem_max_rss": "113901568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:40:05.471348 [debug] [MainThread]: Command `dbt docs serve` failed at 21:40:05.471125 after 0.31 seconds
[0m21:40:05.471710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072df2f0>]}
[0m21:40:05.471986 [debug] [MainThread]: Flushing usage events
[0m21:42:19.264556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f28aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f55e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f557c0>]}


============================== 21:42:19.266573 | c22ef126-6d48-4c0f-9405-5e541abf7123 ==============================
[0m21:42:19.266573 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:42:19.266920 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:42:19.393238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22ef126-6d48-4c0f-9405-5e541abf7123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e053a0>]}
[0m21:42:19.418899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22ef126-6d48-4c0f-9405-5e541abf7123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938f470>]}
[0m21:42:19.419411 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:42:19.424556 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:42:19.441527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:42:19.441944 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/exposures/career_path.yml
[0m21:42:19.452528 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='exposures/career_path.yml', modification_time=1715714411.1379523, project_root='/Users/charles/Documents/dbt_meetup4') @ exposures: {'name': 'open_data_curation', 'type': 'application', 'depends_on': "-ref('R_packaged_analyses')", 'owner': {'name': 'Charles T. Gray'}} - at path ['depends_on']: "-ref('R_packaged_analyses')" is not of type 'array'
[0m21:42:19.453499 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.21406867, "process_user_time": 0.920961, "process_kernel_time": 0.095163, "process_mem_max_rss": "114507776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:42:19.453896 [debug] [MainThread]: Command `dbt docs generate` failed at 21:42:19.453818 after 0.21 seconds
[0m21:42:19.454128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897fb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0340b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c48e30>]}
[0m21:42:19.454324 [debug] [MainThread]: Flushing usage events
[0m21:43:10.998630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043cd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10408a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f9b80>]}


============================== 21:43:11.000698 | 5bd78ca5-4173-4bdb-8f1b-0fa8733e7d68 ==============================
[0m21:43:11.000698 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:43:11.001013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:43:11.117099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bd78ca5-4173-4bdb-8f1b-0fa8733e7d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea53a0>]}
[0m21:43:11.142471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bd78ca5-4173-4bdb-8f1b-0fa8733e7d68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a67b0>]}
[0m21:43:11.142923 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:43:11.147728 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:43:11.163116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:43:11.163522 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/exposures/career_path.yml
[0m21:43:11.174055 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid exposures config given in FilePath(searched_path='models', relative_path='exposures/career_path.yml', modification_time=1715714411.1379523, project_root='/Users/charles/Documents/dbt_meetup4') @ exposures: {'name': 'open_data_curation', 'type': 'application', 'depends_on': "-ref('R_packaged_analyses')", 'owner': {'name': 'Charles T. Gray'}} - at path ['depends_on']: "-ref('R_packaged_analyses')" is not of type 'array'
[0m21:43:11.174991 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.20032945, "process_user_time": 0.922922, "process_kernel_time": 0.089068, "process_mem_max_rss": "114917376", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:43:11.175353 [debug] [MainThread]: Command `dbt docs generate` failed at 21:43:11.175284 after 0.20 seconds
[0m21:43:11.175568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a6b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1f1d0>]}
[0m21:43:11.175748 [debug] [MainThread]: Flushing usage events
[0m21:43:33.926235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105821910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bd940>]}


============================== 21:43:33.928320 | 2bf1fdd4-94b0-4691-979c-beb830cfd88a ==============================
[0m21:43:33.928320 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:43:33.928637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:43:34.039218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bf1fdd4-94b0-4691-979c-beb830cfd88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107229520>]}
[0m21:43:34.062573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bf1fdd4-94b0-4691-979c-beb830cfd88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c710>]}
[0m21:43:34.062894 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:43:34.067149 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:43:34.082067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:34.082293 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:34.085235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bf1fdd4-94b0-4691-979c-beb830cfd88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e25a0>]}
[0m21:43:34.086622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bf1fdd4-94b0-4691-979c-beb830cfd88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108112de0>]}
[0m21:43:34.086842 [info ] [MainThread]: Found 4 models, 3 sources, 2 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:43:34.087022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf1fdd4-94b0-4691-979c-beb830cfd88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108112c30>]}
[0m21:43:34.087959 [info ] [MainThread]: 
[0m21:43:34.088362 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:43:34.089001 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:43:34.096828 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:43:34.097041 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:43:34.097189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:34.098740 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:43:34.098934 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:43:34.380527 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:34.381043 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:43:34.381378 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:43:34.464117 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:34.467815 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:43:34.522596 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:43:34.539136 [debug] [MainThread]: Using redshift connection "master"
[0m21:43:34.539599 [debug] [MainThread]: On master: BEGIN
[0m21:43:34.539892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:34.540355 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:43:34.540655 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:43:34.768103 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:34.769694 [debug] [MainThread]: Using redshift connection "master"
[0m21:43:34.770882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:43:34.915526 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:34.920808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bf1fdd4-94b0-4691-979c-beb830cfd88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107471880>]}
[0m21:43:34.921606 [debug] [MainThread]: On master: ROLLBACK
[0m21:43:34.988560 [debug] [MainThread]: On master: Close
[0m21:43:34.991918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:34.992684 [info ] [MainThread]: 
[0m21:43:34.996511 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.pipeline_pilot
[0m21:43:34.998045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.pipeline_pilot)
[0m21:43:34.998799 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.pipeline_pilot
[0m21:43:35.003170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.pipeline_pilot"
[0m21:43:35.004379 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (compile): 21:43:34.999276 => 21:43:35.004101
[0m21:43:35.004814 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.pipeline_pilot
[0m21:43:35.005289 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (execute): 21:43:35.005060 => 21:43:35.005083
[0m21:43:35.006325 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.pipeline_pilot
[0m21:43:35.007291 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m21:43:35.008140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.pipeline_pilot, now model.dbt_meetup4.R_language)
[0m21:43:35.008530 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m21:43:35.011457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m21:43:35.012278 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 21:43:35.008755 => 21:43:35.012058
[0m21:43:35.012627 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m21:43:35.013021 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 21:43:35.012839 => 21:43:35.012848
[0m21:43:35.013876 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m21:43:35.014417 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_packaged_analyses
[0m21:43:35.015072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_language, now model.dbt_meetup4.R_packaged_analyses)
[0m21:43:35.015508 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_packaged_analyses
[0m21:43:35.017728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_packaged_analyses"
[0m21:43:35.018392 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (compile): 21:43:35.015694 => 21:43:35.018217
[0m21:43:35.018675 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_packaged_analyses
[0m21:43:35.018998 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (execute): 21:43:35.018848 => 21:43:35.018854
[0m21:43:35.019681 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_packaged_analyses
[0m21:43:35.020166 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_targets
[0m21:43:35.020700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_packaged_analyses, now model.dbt_meetup4.R_targets)
[0m21:43:35.020962 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_targets
[0m21:43:35.022981 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_targets"
[0m21:43:35.023506 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (compile): 21:43:35.021128 => 21:43:35.023349
[0m21:43:35.023777 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_targets
[0m21:43:35.024091 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (execute): 21:43:35.023940 => 21:43:35.023946
[0m21:43:35.024722 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_targets
[0m21:43:35.025274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:35.025490 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_targets' was properly closed.
[0m21:43:35.026135 [debug] [MainThread]: Command end result
[0m21:43:35.032237 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:43:35.032476 [info ] [MainThread]: Building catalog
[0m21:43:35.034151 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:43:35.047380 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:43:35.047684 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:43:35.048081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:35.048414 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:43:35.048605 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:43:35.282589 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:35.283164 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:43:35.283641 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:43:35.526400 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:35.537000 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:43:35.537562 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:43:35.618881 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:43:35.630793 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:43:35.631344 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:43:36.487188 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:43:36.518632 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:43:36.567861 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:43:36.655419 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:43:36.656312 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.7540448, "process_user_time": 1.222184, "process_kernel_time": 0.119403, "process_mem_max_rss": "123289600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:43:36.656640 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:43:36.656577 after 2.75 seconds
[0m21:43:36.656818 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:43:36.656952 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:43:36.657110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c33fb0>]}
[0m21:43:36.657293 [debug] [MainThread]: Flushing usage events
[0m21:44:16.576021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107880890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078addf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ada60>]}


============================== 21:44:16.578072 | e1ca78cb-7ec3-4715-8afc-9c50bee8e228 ==============================
[0m21:44:16.578072 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:44:16.578403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:16.694529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1ca78cb-7ec3-4715-8afc-9c50bee8e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106828470>]}
[0m21:44:16.718272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1ca78cb-7ec3-4715-8afc-9c50bee8e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b04bc0>]}
[0m21:44:16.718627 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:44:16.722990 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:44:16.738484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:16.738729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:16.741887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1ca78cb-7ec3-4715-8afc-9c50bee8e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd2b40>]}
[0m21:44:16.743347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1ca78cb-7ec3-4715-8afc-9c50bee8e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108f8110>]}
[0m21:44:16.743568 [info ] [MainThread]: Found 4 models, 3 sources, 3 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:44:16.743753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ca78cb-7ec3-4715-8afc-9c50bee8e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11082dca0>]}
[0m21:44:16.744835 [info ] [MainThread]: 
[0m21:44:16.745250 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:44:16.745883 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:44:16.753970 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:44:16.754182 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:44:16.754345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:16.755985 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:44:16.756181 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:44:17.019981 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:17.021561 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:44:17.022679 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:44:17.104342 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:17.109579 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:44:17.172778 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:44:17.190599 [debug] [MainThread]: Using redshift connection "master"
[0m21:44:17.191194 [debug] [MainThread]: On master: BEGIN
[0m21:44:17.191541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:17.192045 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:44:17.192338 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:44:17.445850 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:17.447267 [debug] [MainThread]: Using redshift connection "master"
[0m21:44:17.448398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:44:17.584674 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:17.590498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1ca78cb-7ec3-4715-8afc-9c50bee8e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb2510>]}
[0m21:44:17.591381 [debug] [MainThread]: On master: ROLLBACK
[0m21:44:17.666650 [debug] [MainThread]: On master: Close
[0m21:44:17.669395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:17.669888 [info ] [MainThread]: 
[0m21:44:17.673294 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.pipeline_pilot
[0m21:44:17.674698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.pipeline_pilot)
[0m21:44:17.675199 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.pipeline_pilot
[0m21:44:17.678834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.pipeline_pilot"
[0m21:44:17.680063 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (compile): 21:44:17.675469 => 21:44:17.679786
[0m21:44:17.680504 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.pipeline_pilot
[0m21:44:17.681022 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (execute): 21:44:17.680775 => 21:44:17.680804
[0m21:44:17.681898 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.pipeline_pilot
[0m21:44:17.682655 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m21:44:17.683638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.pipeline_pilot, now model.dbt_meetup4.R_language)
[0m21:44:17.684043 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m21:44:17.687021 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m21:44:17.687723 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 21:44:17.684290 => 21:44:17.687531
[0m21:44:17.688072 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m21:44:17.688464 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 21:44:17.688279 => 21:44:17.688287
[0m21:44:17.689223 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m21:44:17.689764 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_packaged_analyses
[0m21:44:17.690327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_language, now model.dbt_meetup4.R_packaged_analyses)
[0m21:44:17.690624 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_packaged_analyses
[0m21:44:17.692700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_packaged_analyses"
[0m21:44:17.693290 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (compile): 21:44:17.690793 => 21:44:17.693125
[0m21:44:17.693576 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_packaged_analyses
[0m21:44:17.693896 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (execute): 21:44:17.693748 => 21:44:17.693753
[0m21:44:17.694605 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_packaged_analyses
[0m21:44:17.695046 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_targets
[0m21:44:17.695587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_packaged_analyses, now model.dbt_meetup4.R_targets)
[0m21:44:17.695857 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_targets
[0m21:44:17.697784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_targets"
[0m21:44:17.698261 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (compile): 21:44:17.696041 => 21:44:17.698120
[0m21:44:17.698506 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_targets
[0m21:44:17.698785 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (execute): 21:44:17.698658 => 21:44:17.698663
[0m21:44:17.699377 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_targets
[0m21:44:17.699936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:17.700170 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_targets' was properly closed.
[0m21:44:17.700815 [debug] [MainThread]: Command end result
[0m21:44:17.706829 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:44:17.707064 [info ] [MainThread]: Building catalog
[0m21:44:17.708739 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:44:17.721634 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:44:17.721947 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:44:17.722139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:17.722430 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:44:17.722616 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:44:17.915337 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:17.916038 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:44:17.916743 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:44:18.407171 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:18.416223 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:44:18.416811 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:44:18.573470 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:44:18.588621 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:44:18.589431 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:44:19.576143 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:44:19.605817 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:44:19.652222 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:44:19.738893 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:44:19.739770 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.1875079, "process_user_time": 1.224487, "process_kernel_time": 0.123475, "process_mem_max_rss": "125845504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:44:19.740102 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:44:19.740039 after 3.19 seconds
[0m21:44:19.740276 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:44:19.740414 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:44:19.740573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107599070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078825a0>]}
[0m21:44:19.740757 [debug] [MainThread]: Flushing usage events
[0m21:44:22.584941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084702f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a17f0>]}


============================== 21:44:22.587047 | 75c77b2c-5683-4ff6-b43d-60f3e33e40e8 ==============================
[0m21:44:22.587047 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:44:22.587362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:22.701312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75c77b2c-5683-4ff6-b43d-60f3e33e40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10887d520>]}
[0m21:44:22.725995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75c77b2c-5683-4ff6-b43d-60f3e33e40e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f95b0>]}
[0m21:48:05.621346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f81220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa99d0>]}


============================== 21:48:05.623436 | cd23cec5-f932-4639-89b2-0adba764a2b5 ==============================
[0m21:48:05.623436 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:48:05.623761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:05.743302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd23cec5-f932-4639-89b2-0adba764a2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f59790>]}
[0m21:48:05.768888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd23cec5-f932-4639-89b2-0adba764a2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105019040>]}
[0m21:48:05.769375 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:48:05.774087 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:48:05.789496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:05.789750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:05.792812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd23cec5-f932-4639-89b2-0adba764a2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105608f80>]}
[0m21:48:05.794226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd23cec5-f932-4639-89b2-0adba764a2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613aa50>]}
[0m21:48:05.794457 [info ] [MainThread]: Found 5 models, 3 sources, 5 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:48:05.794646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd23cec5-f932-4639-89b2-0adba764a2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b05c0>]}
[0m21:48:05.795628 [info ] [MainThread]: 
[0m21:48:05.796040 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:48:05.796694 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:48:05.804949 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:48:05.805168 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:48:05.805324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:05.806970 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:05.807157 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:06.092317 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:06.093941 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:48:06.095077 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:48:06.192944 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:06.197743 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:48:06.254172 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:48:06.269278 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:06.269749 [debug] [MainThread]: On master: BEGIN
[0m21:48:06.270080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:06.270597 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:06.270935 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:06.528376 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:06.529854 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:06.530986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:48:06.662681 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:06.667849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd23cec5-f932-4639-89b2-0adba764a2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613be00>]}
[0m21:48:06.668692 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:06.736719 [debug] [MainThread]: On master: Close
[0m21:48:06.739386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:06.739859 [info ] [MainThread]: 
[0m21:48:06.743431 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.pipeline_pilot
[0m21:48:06.744742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.pipeline_pilot)
[0m21:48:06.745174 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.pipeline_pilot
[0m21:48:06.748731 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.pipeline_pilot"
[0m21:48:06.749803 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (compile): 21:48:06.745446 => 21:48:06.749560
[0m21:48:06.750213 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.pipeline_pilot
[0m21:48:06.750659 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (execute): 21:48:06.750449 => 21:48:06.750467
[0m21:48:06.751518 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.pipeline_pilot
[0m21:48:06.751888 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.python
[0m21:48:06.752968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.pipeline_pilot, now model.dbt_meetup4.python)
[0m21:48:06.753402 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.python
[0m21:48:06.756151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.python"
[0m21:48:06.756899 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.python (compile): 21:48:06.753630 => 21:48:06.756701
[0m21:48:06.757237 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.python
[0m21:48:06.757617 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.python (execute): 21:48:06.757437 => 21:48:06.757448
[0m21:48:06.758426 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.python
[0m21:48:06.758764 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m21:48:06.759336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.python, now model.dbt_meetup4.R_language)
[0m21:48:06.759610 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m21:48:06.761857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m21:48:06.762400 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 21:48:06.759775 => 21:48:06.762240
[0m21:48:06.762693 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m21:48:06.763014 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 21:48:06.762863 => 21:48:06.762872
[0m21:48:06.763677 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m21:48:06.764165 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_packaged_analyses
[0m21:48:06.764695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_language, now model.dbt_meetup4.R_packaged_analyses)
[0m21:48:06.764955 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_packaged_analyses
[0m21:48:06.766928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_packaged_analyses"
[0m21:48:06.767370 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (compile): 21:48:06.765116 => 21:48:06.767233
[0m21:48:06.767615 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_packaged_analyses
[0m21:48:06.767892 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (execute): 21:48:06.767761 => 21:48:06.767766
[0m21:48:06.768480 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_packaged_analyses
[0m21:48:06.768908 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_targets
[0m21:48:06.769391 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_packaged_analyses, now model.dbt_meetup4.R_targets)
[0m21:48:06.769641 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_targets
[0m21:48:06.771489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_targets"
[0m21:48:06.771945 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (compile): 21:48:06.769796 => 21:48:06.771801
[0m21:48:06.772180 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_targets
[0m21:48:06.772461 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (execute): 21:48:06.772332 => 21:48:06.772337
[0m21:48:06.773048 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_targets
[0m21:48:06.773581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:06.773788 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_targets' was properly closed.
[0m21:48:06.774456 [debug] [MainThread]: Command end result
[0m21:48:06.782756 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:48:06.782999 [info ] [MainThread]: Building catalog
[0m21:48:06.784719 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:48:06.796540 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:48:06.796774 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:48:06.796941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:06.797205 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:06.797381 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:07.006807 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:07.007252 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:48:07.007618 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:48:07.236029 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:07.246687 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:48:07.247332 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:48:07.325786 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:07.341043 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:48:07.341861 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:48:08.235262 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:08.264059 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:48:08.317060 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:48:08.403371 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:48:08.404270 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.8068862, "process_user_time": 1.240022, "process_kernel_time": 0.131477, "process_mem_max_rss": "124387328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:48:08.404596 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:48:08.404533 after 2.81 seconds
[0m21:48:08.404766 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:48:08.404910 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:48:08.405077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cc2cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c43410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fd4da0>]}
[0m21:48:08.405267 [debug] [MainThread]: Flushing usage events
[0m21:48:11.069727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e9700>]}


============================== 21:48:11.071799 | f5cb6f83-86e5-47bf-9274-303890bafae7 ==============================
[0m21:48:11.071799 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:48:11.072142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:11.186483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5cb6f83-86e5-47bf-9274-303890bafae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f0e630>]}
[0m21:48:11.210182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5cb6f83-86e5-47bf-9274-303890bafae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a1760>]}
[0m21:52:03.803485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119781250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197addf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197ada60>]}


============================== 21:52:03.806015 | 018e2139-6ee8-4421-804d-aa6c971f5c3e ==============================
[0m21:52:03.806015 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:52:03.806321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:03.944494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '018e2139-6ee8-4421-804d-aa6c971f5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198198b0>]}
[0m21:52:03.968198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '018e2139-6ee8-4421-804d-aa6c971f5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119a92210>]}
[0m21:52:03.968576 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:52:03.972991 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m21:52:03.988538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:03.988729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:03.991553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '018e2139-6ee8-4421-804d-aa6c971f5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7cb080>]}
[0m21:52:03.992906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '018e2139-6ee8-4421-804d-aa6c971f5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a7f6990>]}
[0m21:52:03.993108 [info ] [MainThread]: Found 9 models, 3 sources, 6 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:52:03.993294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018e2139-6ee8-4421-804d-aa6c971f5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119759c10>]}
[0m21:52:03.994300 [info ] [MainThread]: 
[0m21:52:03.994736 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:52:03.995393 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m21:52:04.003111 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:52:04.003304 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m21:52:04.003461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:04.004949 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:52:04.005169 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:52:04.276757 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:04.278154 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m21:52:04.278998 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m21:52:04.358962 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:04.363789 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m21:52:04.417226 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m21:52:04.431964 [debug] [MainThread]: Using redshift connection "master"
[0m21:52:04.432558 [debug] [MainThread]: On master: BEGIN
[0m21:52:04.432909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:52:04.433427 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:52:04.433770 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:52:04.646375 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:04.647761 [debug] [MainThread]: Using redshift connection "master"
[0m21:52:04.648912 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:52:04.774047 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:04.780342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '018e2139-6ee8-4421-804d-aa6c971f5c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a323800>]}
[0m21:52:04.781005 [debug] [MainThread]: On master: ROLLBACK
[0m21:52:04.841291 [debug] [MainThread]: On master: Close
[0m21:52:04.844463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:52:04.845560 [info ] [MainThread]: 
[0m21:52:04.851367 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.DBT
[0m21:52:04.852735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.DBT)
[0m21:52:04.853288 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.DBT
[0m21:52:04.855823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.DBT"
[0m21:52:04.856409 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.DBT (compile): 21:52:04.853777 => 21:52:04.856155
[0m21:52:04.856817 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.DBT
[0m21:52:04.857497 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.DBT (execute): 21:52:04.857073 => 21:52:04.857095
[0m21:52:04.858973 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.DBT
[0m21:52:04.859463 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.fivetran
[0m21:52:04.860380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.DBT, now model.dbt_meetup4.fivetran)
[0m21:52:04.860908 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.fivetran
[0m21:52:04.862642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.fivetran"
[0m21:52:04.863072 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.fivetran (compile): 21:52:04.861191 => 21:52:04.862878
[0m21:52:04.863406 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.fivetran
[0m21:52:04.863784 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.fivetran (execute): 21:52:04.863605 => 21:52:04.863613
[0m21:52:04.864658 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.fivetran
[0m21:52:04.865032 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.pipeline_pilot
[0m21:52:04.865717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.fivetran, now model.dbt_meetup4.pipeline_pilot)
[0m21:52:04.866114 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.pipeline_pilot
[0m21:52:04.869055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.pipeline_pilot"
[0m21:52:04.869877 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (compile): 21:52:04.866344 => 21:52:04.869710
[0m21:52:04.870196 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.pipeline_pilot
[0m21:52:04.870545 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (execute): 21:52:04.870386 => 21:52:04.870393
[0m21:52:04.871273 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.pipeline_pilot
[0m21:52:04.871578 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.python
[0m21:52:04.872155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.pipeline_pilot, now model.dbt_meetup4.python)
[0m21:52:04.872492 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.python
[0m21:52:04.874602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.python"
[0m21:52:04.875169 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.python (compile): 21:52:04.872660 => 21:52:04.875009
[0m21:52:04.875450 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.python
[0m21:52:04.875759 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.python (execute): 21:52:04.875619 => 21:52:04.875624
[0m21:52:04.876483 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.python
[0m21:52:04.876818 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.redshift
[0m21:52:04.877382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.python, now model.dbt_meetup4.redshift)
[0m21:52:04.877639 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.redshift
[0m21:52:04.878773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.redshift"
[0m21:52:04.879068 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.redshift (compile): 21:52:04.877785 => 21:52:04.878934
[0m21:52:04.879311 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.redshift
[0m21:52:04.879583 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.redshift (execute): 21:52:04.879457 => 21:52:04.879461
[0m21:52:04.880174 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.redshift
[0m21:52:04.880430 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.tableau
[0m21:52:04.880896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.redshift, now model.dbt_meetup4.tableau)
[0m21:52:04.881150 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.tableau
[0m21:52:04.882224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.tableau"
[0m21:52:04.882536 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.tableau (compile): 21:52:04.881295 => 21:52:04.882401
[0m21:52:04.882762 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.tableau
[0m21:52:04.883060 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.tableau (execute): 21:52:04.882925 => 21:52:04.882930
[0m21:52:04.883644 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.tableau
[0m21:52:04.883900 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m21:52:04.884372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.tableau, now model.dbt_meetup4.R_language)
[0m21:52:04.884598 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m21:52:04.886536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m21:52:04.887003 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 21:52:04.884751 => 21:52:04.886872
[0m21:52:04.887251 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m21:52:04.887508 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 21:52:04.887391 => 21:52:04.887395
[0m21:52:04.888053 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m21:52:04.888505 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_packaged_analyses
[0m21:52:04.889061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_language, now model.dbt_meetup4.R_packaged_analyses)
[0m21:52:04.889319 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_packaged_analyses
[0m21:52:04.893310 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_packaged_analyses"
[0m21:52:04.893807 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (compile): 21:52:04.889471 => 21:52:04.893677
[0m21:52:04.894031 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_packaged_analyses
[0m21:52:04.894289 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (execute): 21:52:04.894166 => 21:52:04.894173
[0m21:52:04.894827 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_packaged_analyses
[0m21:52:04.895152 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_targets
[0m21:52:04.895572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_packaged_analyses, now model.dbt_meetup4.R_targets)
[0m21:52:04.895816 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_targets
[0m21:52:04.897357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_targets"
[0m21:52:04.897770 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (compile): 21:52:04.895949 => 21:52:04.897641
[0m21:52:04.897992 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_targets
[0m21:52:04.898236 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (execute): 21:52:04.898123 => 21:52:04.898127
[0m21:52:04.898751 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_targets
[0m21:52:04.899277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:04.899468 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_targets' was properly closed.
[0m21:52:04.900331 [debug] [MainThread]: Command end result
[0m21:52:04.906922 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m21:52:04.907129 [info ] [MainThread]: Building catalog
[0m21:52:04.909030 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m21:52:04.920164 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:52:04.920399 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m21:52:04.920569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:04.920827 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:52:04.920996 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:52:05.284522 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:05.286208 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:52:05.287569 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m21:52:05.590936 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:05.603365 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:52:05.603933 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m21:52:05.679995 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:52:05.693714 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m21:52:05.694519 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m21:52:06.622777 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m21:52:06.653112 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m21:52:06.712858 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m21:52:06.798578 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m21:52:06.799802 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.0213969, "process_user_time": 1.254392, "process_kernel_time": 0.140921, "process_mem_max_rss": "122191872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:52:06.800154 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:52:06.800091 after 3.02 seconds
[0m21:52:06.800346 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:52:06.800484 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m21:52:06.800644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197addc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119dab1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10356f290>]}
[0m21:52:06.800835 [debug] [MainThread]: Flushing usage events
[0m21:52:09.638611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bdb9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bde9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bde97c0>]}


============================== 21:52:09.641090 | 7c3ec6e8-c28a-4538-86fe-4ae5acf087c5 ==============================
[0m21:52:09.641090 [info ] [MainThread]: Running with dbt=1.7.14
[0m21:52:09.641437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:09.757356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c3ec6e8-c28a-4538-86fe-4ae5acf087c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ba9b3e0>]}
[0m21:52:09.781676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c3ec6e8-c28a-4538-86fe-4ae5acf087c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c389a30>]}
[0m22:08:10.941468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f83200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fadd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fad910>]}


============================== 22:08:10.943952 | abdaecd2-5a81-414e-82b1-cb245c5c73d7 ==============================
[0m22:08:10.943952 [info ] [MainThread]: Running with dbt=1.7.14
[0m22:08:10.944280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m22:08:11.095094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abdaecd2-5a81-414e-82b1-cb245c5c73d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a91730>]}
[0m22:08:11.120963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abdaecd2-5a81-414e-82b1-cb245c5c73d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1c920>]}
[0m22:08:11.121587 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:08:11.126398 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m22:08:11.143064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:11.143281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:11.146333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abdaecd2-5a81-414e-82b1-cb245c5c73d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637f410>]}
[0m22:08:11.147797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abdaecd2-5a81-414e-82b1-cb245c5c73d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106936b10>]}
[0m22:08:11.148015 [info ] [MainThread]: Found 9 models, 3 sources, 6 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:08:11.148204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdaecd2-5a81-414e-82b1-cb245c5c73d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f59c10>]}
[0m22:08:11.149284 [info ] [MainThread]: 
[0m22:08:11.149700 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:08:11.150342 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m22:08:11.158357 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m22:08:11.158546 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m22:08:11.158722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:11.160262 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:11.160465 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:08:11.496933 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:11.498347 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m22:08:11.498847 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m22:08:11.580004 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:11.585252 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m22:08:11.644543 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m22:08:11.660592 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:11.661207 [debug] [MainThread]: On master: BEGIN
[0m22:08:11.661548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:11.662059 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:11.662400 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:08:11.869661 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:11.871098 [debug] [MainThread]: Using redshift connection "master"
[0m22:08:11.872323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:08:11.995811 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:12.001335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abdaecd2-5a81-414e-82b1-cb245c5c73d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f08590>]}
[0m22:08:12.002010 [debug] [MainThread]: On master: ROLLBACK
[0m22:08:12.064082 [debug] [MainThread]: On master: Close
[0m22:08:12.066441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:08:12.067077 [info ] [MainThread]: 
[0m22:08:12.071787 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.DBT
[0m22:08:12.072990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.DBT)
[0m22:08:12.073487 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.DBT
[0m22:08:12.077226 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.DBT"
[0m22:08:12.078785 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.DBT (compile): 22:08:12.073753 => 22:08:12.078511
[0m22:08:12.079273 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.DBT
[0m22:08:12.080305 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.DBT (execute): 22:08:12.079842 => 22:08:12.079874
[0m22:08:12.081522 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.DBT
[0m22:08:12.081926 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.fivetran
[0m22:08:12.082834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.DBT, now model.dbt_meetup4.fivetran)
[0m22:08:12.083244 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.fivetran
[0m22:08:12.086015 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.fivetran"
[0m22:08:12.086824 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.fivetran (compile): 22:08:12.083455 => 22:08:12.086610
[0m22:08:12.087161 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.fivetran
[0m22:08:12.087503 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.fivetran (execute): 22:08:12.087343 => 22:08:12.087353
[0m22:08:12.088232 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.fivetran
[0m22:08:12.088546 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.pipeline_pilot
[0m22:08:12.089091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.fivetran, now model.dbt_meetup4.pipeline_pilot)
[0m22:08:12.089352 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.pipeline_pilot
[0m22:08:12.091470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.pipeline_pilot"
[0m22:08:12.092279 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (compile): 22:08:12.089512 => 22:08:12.092106
[0m22:08:12.092575 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.pipeline_pilot
[0m22:08:12.092896 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.pipeline_pilot (execute): 22:08:12.092742 => 22:08:12.092748
[0m22:08:12.093577 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.pipeline_pilot
[0m22:08:12.093874 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.python
[0m22:08:12.094477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.pipeline_pilot, now model.dbt_meetup4.python)
[0m22:08:12.094749 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.python
[0m22:08:12.096778 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.python"
[0m22:08:12.097405 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.python (compile): 22:08:12.094910 => 22:08:12.097258
[0m22:08:12.097659 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.python
[0m22:08:12.097943 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.python (execute): 22:08:12.097810 => 22:08:12.097814
[0m22:08:12.098540 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.python
[0m22:08:12.098810 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.redshift
[0m22:08:12.099290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.python, now model.dbt_meetup4.redshift)
[0m22:08:12.099524 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.redshift
[0m22:08:12.101321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.redshift"
[0m22:08:12.101781 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.redshift (compile): 22:08:12.099665 => 22:08:12.101636
[0m22:08:12.102031 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.redshift
[0m22:08:12.102309 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.redshift (execute): 22:08:12.102180 => 22:08:12.102184
[0m22:08:12.102899 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.redshift
[0m22:08:12.103152 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.tableau
[0m22:08:12.103623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.redshift, now model.dbt_meetup4.tableau)
[0m22:08:12.103847 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.tableau
[0m22:08:12.105626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.tableau"
[0m22:08:12.106071 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.tableau (compile): 22:08:12.103988 => 22:08:12.105942
[0m22:08:12.106293 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.tableau
[0m22:08:12.106547 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.tableau (execute): 22:08:12.106423 => 22:08:12.106428
[0m22:08:12.107079 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.tableau
[0m22:08:12.107318 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m22:08:12.107728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.tableau, now model.dbt_meetup4.R_language)
[0m22:08:12.107942 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m22:08:12.109774 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m22:08:12.110181 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 22:08:12.108071 => 22:08:12.110049
[0m22:08:12.110409 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m22:08:12.110664 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 22:08:12.110543 => 22:08:12.110547
[0m22:08:12.111245 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m22:08:12.111702 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_packaged_analyses
[0m22:08:12.112296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_language, now model.dbt_meetup4.R_packaged_analyses)
[0m22:08:12.112615 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_packaged_analyses
[0m22:08:12.116751 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_packaged_analyses"
[0m22:08:12.117481 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (compile): 22:08:12.112773 => 22:08:12.117317
[0m22:08:12.117732 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_packaged_analyses
[0m22:08:12.117997 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_packaged_analyses (execute): 22:08:12.117881 => 22:08:12.117885
[0m22:08:12.118536 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_packaged_analyses
[0m22:08:12.118968 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_targets
[0m22:08:12.119482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_meetup4.R_packaged_analyses, now model.dbt_meetup4.R_targets)
[0m22:08:12.119724 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_targets
[0m22:08:12.121471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_targets"
[0m22:08:12.121876 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (compile): 22:08:12.119852 => 22:08:12.121746
[0m22:08:12.122084 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_targets
[0m22:08:12.122329 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_targets (execute): 22:08:12.122209 => 22:08:12.122213
[0m22:08:12.122828 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_targets
[0m22:08:12.123271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:08:12.123444 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_targets' was properly closed.
[0m22:08:12.124300 [debug] [MainThread]: Command end result
[0m22:08:12.131357 [debug] [MainThread]: Acquiring new redshift connection 'generate_catalog'
[0m22:08:12.131569 [info ] [MainThread]: Building catalog
[0m22:08:12.133404 [debug] [ThreadPool]: Acquiring new redshift connection 'msw_data_analytics.information_schema'
[0m22:08:12.144063 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m22:08:12.144276 [debug] [ThreadPool]: On msw_data_analytics.information_schema: BEGIN
[0m22:08:12.144436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:12.144677 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:08:12.144847 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:08:12.387361 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:12.389008 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m22:08:12.389909 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */

    

    with late_binding as (
      select
        'msw_data_analytics'::varchar as table_database,
        table_schema,
        table_name,
        'LATE BINDING VIEW'::varchar as table_type,
        null::text as table_comment,

        column_name,
        column_index,
        column_type,
        null::text as column_comment
      from pg_get_late_binding_view_cols()
        cols(table_schema name, table_name name, column_name name,
             column_type varchar,
             column_index int)
        order by "column_index"
    ),

    materialized_views as (
        select
            table_schema  as nspname,
            table_name    as relname
        from information_schema.views
        where (upper(table_schema) = upper('dev_cgray'))
        and table_catalog = 'msw_data_analytics'
        and view_definition ilike '%create materialized view%'
    ),

    early_binding as (
        select
            'msw_data_analytics'::varchar as table_database,
            sch.nspname as table_schema,
            tbl.relname as table_name,
            case
                when tbl.relkind = 'v' and materialized_views.relname is not null then 'MATERIALIZED VIEW'
                when tbl.relkind = 'v' then 'VIEW'
                else 'BASE TABLE'
            end as table_type,
            tbl_desc.description as table_comment,
            col.attname as column_name,
            col.attnum as column_index,
            pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
            col_desc.description as column_comment

        from pg_catalog.pg_namespace sch
        join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
        join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
        left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
        left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
        left outer join materialized_views on (materialized_views.nspname = sch.nspname and materialized_views.relname = tbl.relname)
        where (upper(sch.nspname) = upper('dev_cgray'))
            and tbl.relkind in ('r', 'v', 'f', 'p')
            and col.attnum > 0
            and not col.attisdropped
    ),

    table_owners as (

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            tablename as table_name,
            tableowner as table_owner

        from pg_tables

        union all

        select
            'msw_data_analytics'::varchar as table_database,
            schemaname as table_schema,
            viewname as table_name,
            viewowner as table_owner

        from pg_views

    ),

    unioned as (

        select *
        from early_binding

        union all

        select *
        from late_binding

    )

    select *,
        table_database || '.' || table_schema || '.' || table_name as table_id

    from unioned
    join table_owners using (table_database, table_schema, table_name)

    where (upper(table_schema) = upper('dev_cgray'))

    order by "column_index"
[0m22:08:12.832697 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:12.842773 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m22:08:12.843375 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select has_table_privilege(current_user, 'svv_table_info', 'SELECT') as can_select
[0m22:08:12.945032 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:08:12.958545 [debug] [ThreadPool]: Using redshift connection "msw_data_analytics.information_schema"
[0m22:08:12.959275 [debug] [ThreadPool]: On msw_data_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "msw_data_analytics.information_schema"} */
select
        "database" || '.' || "schema" || '.' || "table" as table_id,

        'Encoded'::text as "stats:encoded:label",
        encoded as "stats:encoded:value",
        'Indicates whether any column in the table has compression encoding defined.'::text as "stats:encoded:description",
        true as "stats:encoded:include",

        'Dist Style' as "stats:diststyle:label",
        diststyle as "stats:diststyle:value",
        'Distribution style or distribution key column, if key distribution is defined.'::text as "stats:diststyle:description",
        true as "stats:diststyle:include",

        'Sort Key 1' as "stats:sortkey1:label",
        -- handle 0xFF byte in response for interleaved sort styles
        case
            when sortkey1 like 'INTERLEAVED%' then 'INTERLEAVED'::text
            else sortkey1
        end as "stats:sortkey1:value",
        'First column in the sort key.'::text as "stats:sortkey1:description",
        (sortkey1 is not null) as "stats:sortkey1:include",

        'Max Varchar' as "stats:max_varchar:label",
        max_varchar as "stats:max_varchar:value",
        'Size of the largest column that uses a VARCHAR data type.'::text as "stats:max_varchar:description",
        true as "stats:max_varchar:include",

        -- exclude this, as the data is strangely returned with null-byte characters
        'Sort Key 1 Encoding' as "stats:sortkey1_enc:label",
        sortkey1_enc as "stats:sortkey1_enc:value",
        'Compression encoding of the first column in the sort key.' as "stats:sortkey1_enc:description",
        false as "stats:sortkey1_enc:include",

        '# Sort Keys' as "stats:sortkey_num:label",
        sortkey_num as "stats:sortkey_num:value",
        'Number of columns defined as sort keys.' as "stats:sortkey_num:description",
        (sortkey_num > 0) as "stats:sortkey_num:include",

        'Approximate Size' as "stats:size:label",
        size * 1000000 as "stats:size:value",
        'Approximate size of the table, calculated from a count of 1MB blocks'::text as "stats:size:description",
        true as "stats:size:include",

        'Disk Utilization' as "stats:pct_used:label",
        pct_used / 100.0 as "stats:pct_used:value",
        'Percent of available space that is used by the table.'::text as "stats:pct_used:description",
        true as "stats:pct_used:include",

        'Unsorted %' as "stats:unsorted:label",
        unsorted / 100.0 as "stats:unsorted:value",
        'Percent of unsorted rows in the table.'::text as "stats:unsorted:description",
        (unsorted is not null) as "stats:unsorted:include",

        'Stats Off' as "stats:stats_off:label",
        stats_off as "stats:stats_off:value",
        'Number that indicates how stale the table statistics are; 0 is current, 100 is out of date.'::text as "stats:stats_off:description",
        true as "stats:stats_off:include",

        'Approximate Row Count' as "stats:rows:label",
        tbl_rows as "stats:rows:value",
        'Approximate number of rows in the table. This value includes rows marked for deletion, but not yet vacuumed.'::text as "stats:rows:description",
        true as "stats:rows:include",

        'Sort Key Skew' as "stats:skew_sortkey1:label",
        skew_sortkey1 as "stats:skew_sortkey1:value",
        'Ratio of the size of the largest non-sort key column to the size of the first column of the sort key.'::text as "stats:skew_sortkey1:description",
        (skew_sortkey1 is not null) as "stats:skew_sortkey1:include",

        'Skew Rows' as "stats:skew_rows:label",
        skew_rows as "stats:skew_rows:value",
        'Ratio of the number of rows in the slice with the most rows to the number of rows in the slice with the fewest rows.'::text as "stats:skew_rows:description",
        (skew_rows is not null) as "stats:skew_rows:include"

    from svv_table_info
    where (upper(schema) = upper('dev_cgray'))
[0m22:08:13.934961 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:08:13.966190 [debug] [ThreadPool]: On msw_data_analytics.information_schema: ROLLBACK
[0m22:08:14.026576 [debug] [ThreadPool]: On msw_data_analytics.information_schema: Close
[0m22:08:14.114942 [info ] [MainThread]: Catalog written to /Users/charles/Documents/dbt_meetup4/target/catalog.json
[0m22:08:14.116648 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 3.2003963, "process_user_time": 1.266396, "process_kernel_time": 0.146049, "process_mem_max_rss": "125091840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:08:14.116985 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:08:14.116922 after 3.20 seconds
[0m22:08:14.117159 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:08:14.117295 [debug] [MainThread]: Connection 'msw_data_analytics.information_schema' was properly closed.
[0m22:08:14.117456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10306fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630fef0>]}
[0m22:08:14.117646 [debug] [MainThread]: Flushing usage events
[0m22:08:16.675309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aadc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aad8e0>]}


============================== 22:08:16.677394 | b0a0db04-8a95-455b-9118-ee625d09362d ==============================
[0m22:08:16.677394 [info ] [MainThread]: Running with dbt=1.7.14
[0m22:08:16.677709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:16.790837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0a0db04-8a95-455b-9118-ee625d09362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d92f30>]}
[0m22:08:16.814551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0a0db04-8a95-455b-9118-ee625d09362d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130af200>]}
[0m00:12:33.582079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047997c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c5910>]}


============================== 00:12:33.584686 | 12ec7553-e577-41a7-a5f0-e44379342505 ==============================
[0m00:12:33.584686 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:12:33.584999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s R_language', 'send_anonymous_usage_stats': 'True'}
[0m00:12:33.747563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc9f70>]}
[0m00:12:33.771057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467e840>]}
[0m00:12:33.771589 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m00:12:33.776180 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:12:33.804939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:33.805149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:33.808159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c56a0>]}
[0m00:12:33.813562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570aab0>]}
[0m00:12:33.813777 [info ] [MainThread]: Found 9 models, 3 sources, 6 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m00:12:33.813953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105895d60>]}
[0m00:12:33.814757 [info ] [MainThread]: 
[0m00:12:33.815169 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:12:33.815701 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics'
[0m00:12:33.823083 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics"
[0m00:12:33.823294 [debug] [ThreadPool]: On list_msw_data_analytics: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics"} */

    select distinct nspname from pg_namespace
[0m00:12:33.823460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:33.825052 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:12:33.825235 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:12:34.145346 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:34.149727 [debug] [ThreadPool]: On list_msw_data_analytics: Close
[0m00:12:34.152965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_msw_data_analytics, now list_msw_data_analytics_dev_cgray)
[0m00:12:34.161086 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m00:12:34.161458 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m00:12:34.161749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:12:34.162235 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:12:34.162545 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:12:35.400720 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m00:12:35.402251 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m00:12:35.403477 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m00:12:35.486981 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:35.488727 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m00:12:35.540324 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m00:12:35.552029 [debug] [MainThread]: Using redshift connection "master"
[0m00:12:35.552383 [debug] [MainThread]: On master: BEGIN
[0m00:12:35.552663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:35.553093 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:12:35.553380 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:12:35.751512 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:35.752788 [debug] [MainThread]: Using redshift connection "master"
[0m00:12:35.753917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:12:35.891602 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:35.896698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056dc590>]}
[0m00:12:35.897459 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:35.960374 [debug] [MainThread]: Using redshift connection "master"
[0m00:12:35.961585 [debug] [MainThread]: On master: BEGIN
[0m00:12:35.984522 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:35.985613 [debug] [MainThread]: On master: COMMIT
[0m00:12:35.986661 [debug] [MainThread]: Using redshift connection "master"
[0m00:12:35.987528 [debug] [MainThread]: On master: COMMIT
[0m00:12:36.038113 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:36.039346 [debug] [MainThread]: On master: Close
[0m00:12:36.041976 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:36.042626 [info ] [MainThread]: 
[0m00:12:36.047092 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.R_language
[0m00:12:36.047779 [info ] [Thread-1 (]: 1 of 1 START sql view model dev_cgray.R_language ............................... [RUN]
[0m00:12:36.048586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.R_language)
[0m00:12:36.048934 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.R_language
[0m00:12:36.052112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.R_language"
[0m00:12:36.053515 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (compile): 00:12:36.049148 => 00:12:36.053156
[0m00:12:36.053948 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.R_language
[0m00:12:36.082618 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_meetup4.R_language"
[0m00:12:36.084060 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.R_language"
[0m00:12:36.084389 [debug] [Thread-1 (]: On model.dbt_meetup4.R_language: BEGIN
[0m00:12:36.084602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:12:36.084926 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:12:36.085147 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:12:36.299233 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:36.300157 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.R_language"
[0m00:12:36.300996 [debug] [Thread-1 (]: On model.dbt_meetup4.R_language: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.R_language"} */


  create view "msw_data_analytics"."dev_cgray"."R_language__dbt_tmp" as (
    with pp as (select * from "msw_data_analytics"."dev_cgray"."pipeline_pilot")
select * from "msw_data_analytics"."dev_cgray"."stg_ed_statistics_phd"
  ) ;
[0m00:12:36.329978 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "dev_cgray.pipeline_pilot" does not exist
[0m00:12:36.330954 [debug] [Thread-1 (]: On model.dbt_meetup4.R_language: ROLLBACK
[0m00:12:36.382853 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.R_language (execute): 00:12:36.054152 => 00:12:36.381991
[0m00:12:36.384223 [debug] [Thread-1 (]: On model.dbt_meetup4.R_language: Close
[0m00:12:36.393843 [debug] [Thread-1 (]: Database Error in model R_language (models/intermediate/R_language.sql)
  relation "dev_cgray.pipeline_pilot" does not exist
  compiled Code at target/run/dbt_meetup4/models/intermediate/R_language.sql
[0m00:12:36.394670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12ec7553-e577-41a7-a5f0-e44379342505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd25a0>]}
[0m00:12:36.395488 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dev_cgray.R_language ...................... [[31mERROR[0m in 0.35s]
[0m00:12:36.396256 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.R_language
[0m00:12:36.398737 [debug] [MainThread]: Using redshift connection "master"
[0m00:12:36.399181 [debug] [MainThread]: On master: BEGIN
[0m00:12:36.399524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:12:36.400005 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:12:36.400351 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:12:36.621821 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:36.623584 [debug] [MainThread]: On master: COMMIT
[0m00:12:36.624568 [debug] [MainThread]: Using redshift connection "master"
[0m00:12:36.625094 [debug] [MainThread]: On master: COMMIT
[0m00:12:36.690371 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:12:36.691648 [debug] [MainThread]: On master: Close
[0m00:12:36.693534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:36.693948 [debug] [MainThread]: Connection 'model.dbt_meetup4.R_language' was properly closed.
[0m00:12:36.694410 [info ] [MainThread]: 
[0m00:12:36.695417 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m00:12:36.696527 [debug] [MainThread]: Command end result
[0m00:12:36.708309 [info ] [MainThread]: 
[0m00:12:36.708898 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:12:36.709254 [info ] [MainThread]: 
[0m00:12:36.709601 [error] [MainThread]:   Database Error in model R_language (models/intermediate/R_language.sql)
  relation "dev_cgray.pipeline_pilot" does not exist
  compiled Code at target/run/dbt_meetup4/models/intermediate/R_language.sql
[0m00:12:36.709924 [info ] [MainThread]: 
[0m00:12:36.710255 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:12:36.712631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1570413, "process_user_time": 1.178671, "process_kernel_time": 0.167237, "process_mem_max_rss": "122552320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:12:36.713434 [debug] [MainThread]: Command `dbt run` failed at 00:12:36.713298 after 3.16 seconds
[0m00:12:36.713887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104674dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2c440>]}
[0m00:12:36.714270 [debug] [MainThread]: Flushing usage events
[0m00:22:23.770489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e9670>]}


============================== 00:22:23.773087 | 250c07da-25f3-4837-8071-7c5a7ea7993f ==============================
[0m00:22:23.773087 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:22:23.773390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test -s fivetran', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:22:23.918896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '250c07da-25f3-4837-8071-7c5a7ea7993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e40b0>]}
[0m00:22:23.942406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '250c07da-25f3-4837-8071-7c5a7ea7993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105410d70>]}
[0m00:22:23.943526 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m00:22:23.948127 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:22:23.973397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:23.973587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:23.976498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '250c07da-25f3-4837-8071-7c5a7ea7993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c088c0>]}
[0m00:22:23.981601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '250c07da-25f3-4837-8071-7c5a7ea7993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f2ff0>]}
[0m00:22:23.981819 [info ] [MainThread]: Found 9 models, 3 sources, 6 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m00:22:23.982007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250c07da-25f3-4837-8071-7c5a7ea7993f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067820f0>]}
[0m00:22:23.982757 [info ] [MainThread]: 
[0m00:22:23.982942 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:22:23.983198 [debug] [MainThread]: Command end result
[0m00:22:23.987479 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24343629, "process_user_time": 0.925661, "process_kernel_time": 0.109286, "process_mem_max_rss": "114802688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:22:23.987755 [debug] [MainThread]: Command `dbt test` succeeded at 00:22:23.987697 after 0.24 seconds
[0m00:22:23.987946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caac30>]}
[0m00:22:23.988125 [debug] [MainThread]: Flushing usage events
[0m00:24:28.810577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e84ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ead730>]}


============================== 00:24:28.812578 | 794bc265-54af-4d56-9015-bd5b73fd7ec9 ==============================
[0m00:24:28.812578 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:24:28.812886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt show -s fivetran', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:28.925778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '794bc265-54af-4d56-9015-bd5b73fd7ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053af080>]}
[0m00:24:28.949421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '794bc265-54af-4d56-9015-bd5b73fd7ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051f5220>]}
[0m00:24:28.949768 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m00:24:28.954191 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:24:28.970867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:24:28.971226 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://macros/placeholder_column_categorical.sql
[0m00:24:28.971442 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/intermediate/fivetran.sql
[0m00:24:29.020944 [error] [MainThread]: Encountered an error:
Compilation Error in model fivetran (models/intermediate/fivetran.sql)
  expected token ',', got 'A'
    line 1
      select {{ref('placeholder_column_categorical(['A', 'B'])')}} as test
[0m00:24:29.021844 [debug] [MainThread]: Resource report: {"command_name": "show", "command_wall_clock_time": 0.23489791, "process_user_time": 0.95371, "process_kernel_time": 0.095215, "process_mem_max_rss": "118046720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:24:29.022167 [debug] [MainThread]: Command `dbt show` failed at 00:24:29.022098 after 0.24 seconds
[0m00:24:29.022382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ead730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec6ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106223170>]}
[0m00:24:29.022556 [debug] [MainThread]: Flushing usage events
[0m00:24:44.075129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108431fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108431c40>]}


============================== 00:24:44.077072 | a7c266a8-8347-4fe6-b1a5-683517815a6c ==============================
[0m00:24:44.077072 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:24:44.077398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'profiles_dir': '/Users/charles/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt show -s fivetran', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:24:44.189025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7c266a8-8347-4fe6-b1a5-683517815a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9bb90>]}
[0m00:24:44.212687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7c266a8-8347-4fe6-b1a5-683517815a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108775430>]}
[0m00:24:44.213030 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m00:24:44.217399 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:24:44.232879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:24:44.233199 [debug] [MainThread]: Partial parsing: added file: dbt_meetup4://macros/placeholder_column_categorical.sql
[0m00:24:44.233404 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/intermediate/fivetran.sql
[0m00:24:44.285154 [info ] [MainThread]: Warning: The placeholder_column_categorical macro is being used
[0m00:24:44.297046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7c266a8-8347-4fe6-b1a5-683517815a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963eb10>]}
[0m00:24:44.301809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7c266a8-8347-4fe6-b1a5-683517815a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937e420>]}
[0m00:24:44.302034 [info ] [MainThread]: Found 9 models, 3 sources, 6 exposures, 0 metrics, 456 macros, 0 groups, 0 semantic models
[0m00:24:44.302218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c266a8-8347-4fe6-b1a5-683517815a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095239e0>]}
[0m00:24:44.303015 [info ] [MainThread]: 
[0m00:24:44.303400 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m00:24:44.304045 [debug] [ThreadPool]: Acquiring new redshift connection 'list_msw_data_analytics_dev_cgray'
[0m00:24:44.311426 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m00:24:44.311622 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: BEGIN
[0m00:24:44.311766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:44.313362 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:24:44.313564 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:24:44.778044 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:24:44.779562 [debug] [ThreadPool]: Using redshift connection "list_msw_data_analytics_dev_cgray"
[0m00:24:44.780663 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "list_msw_data_analytics_dev_cgray"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'dev_cgray'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'dev_cgray'
[0m00:24:44.865065 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m00:24:44.870387 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: ROLLBACK
[0m00:24:44.933796 [debug] [ThreadPool]: On list_msw_data_analytics_dev_cgray: Close
[0m00:24:44.947741 [debug] [MainThread]: Using redshift connection "master"
[0m00:24:44.948280 [debug] [MainThread]: On master: BEGIN
[0m00:24:44.948574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:24:44.949038 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:24:44.949334 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:24:45.184304 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:24:45.185695 [debug] [MainThread]: Using redshift connection "master"
[0m00:24:45.186852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m00:24:45.315068 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m00:24:45.320486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7c266a8-8347-4fe6-b1a5-683517815a6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109406b40>]}
[0m00:24:45.321324 [debug] [MainThread]: On master: ROLLBACK
[0m00:24:45.384129 [debug] [MainThread]: On master: Close
[0m00:24:45.387211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:45.388339 [info ] [MainThread]: 
[0m00:24:45.393048 [debug] [Thread-1 (]: Began running node model.dbt_meetup4.fivetran
[0m00:24:45.394383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_msw_data_analytics_dev_cgray, now model.dbt_meetup4.fivetran)
[0m00:24:45.395302 [debug] [Thread-1 (]: Began compiling node model.dbt_meetup4.fivetran
[0m00:24:45.399796 [info ] [Thread-1 (]: Warning: The placeholder_column_categorical macro is being used
[0m00:24:45.400653 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_meetup4.fivetran"
[0m00:24:45.402351 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.fivetran (compile): 00:24:45.395736 => 00:24:45.402028
[0m00:24:45.402834 [debug] [Thread-1 (]: Began executing node model.dbt_meetup4.fivetran
[0m00:24:45.410237 [debug] [Thread-1 (]: Using redshift connection "model.dbt_meetup4.fivetran"
[0m00:24:45.410643 [debug] [Thread-1 (]: On model.dbt_meetup4.fivetran: /* {"app": "dbt", "dbt_version": "1.7.14", "profile_name": "dbt_meetup4", "target_name": "dev", "node_id": "model.dbt_meetup4.fivetran"} */

  
    select *
    from (
        select 
    
    (CASE
        
            WHEN random() < 0.5 THEN 'A'
        
            WHEN random() < 1.0 THEN 'B'
        
    END)
 as test
from "msw_data_analytics"."dev_cgray"."stg_start_ups"
    ) as model_limit_subq
    limit 5
[0m00:24:45.410991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:45.411481 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m00:24:45.411800 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m00:24:45.616829 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "dev_cgray.stg_start_ups" does not exist
[0m00:24:45.618834 [debug] [Thread-1 (]: Timing info for model.dbt_meetup4.fivetran (execute): 00:24:45.403103 => 00:24:45.618187
[0m00:24:45.619932 [debug] [Thread-1 (]: On model.dbt_meetup4.fivetran: Close
[0m00:24:45.627491 [debug] [Thread-1 (]: Database Error in model fivetran (models/intermediate/fivetran.sql)
  relation "dev_cgray.stg_start_ups" does not exist
[0m00:24:45.628429 [debug] [Thread-1 (]: Finished running node model.dbt_meetup4.fivetran
[0m00:24:45.629587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:45.630028 [debug] [MainThread]: Connection 'model.dbt_meetup4.fivetran' was properly closed.
[0m00:24:45.630534 [error] [MainThread]: Encountered an error:
Runtime Error
  Database Error in model fivetran (models/intermediate/fivetran.sql)
    relation "dev_cgray.stg_start_ups" does not exist
[0m00:24:45.632377 [debug] [MainThread]: Resource report: {"command_name": "show", "command_wall_clock_time": 1.580544, "process_user_time": 1.119609, "process_kernel_time": 0.117021, "process_mem_max_rss": "125140992", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:24:45.632969 [debug] [MainThread]: Command `dbt show` failed at 00:24:45.632844 after 1.58 seconds
[0m00:24:45.633349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109579d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109635040>]}
[0m00:24:45.633718 [debug] [MainThread]: Flushing usage events
[0m00:25:08.727922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106485c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d9b50>]}


============================== 00:25:08.729872 | c265b715-0412-4e8d-ad9f-ef81b3b90291 ==============================
[0m00:25:08.729872 [info ] [MainThread]: Running with dbt=1.7.14
[0m00:25:08.730190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/charles/.dbt', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt show -s fivetran', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:25:08.839901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c265b715-0412-4e8d-ad9f-ef81b3b90291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0f7a0>]}
[0m00:25:08.863467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c265b715-0412-4e8d-ad9f-ef81b3b90291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fc9b0>]}
[0m00:25:08.863810 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m00:25:08.867999 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m00:25:08.882753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:08.883051 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/intermediate/fivetran.sql
[0m00:25:08.932295 [info ] [MainThread]: Warning: The placeholder_column_categorical macro is being used
[0m00:25:08.939260 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_meetup4.fivetran' (models/intermediate/fivetran.sql) depends on a source named 'dev_cgray.career_phase' which was not found
[0m00:25:08.940128 [debug] [MainThread]: Resource report: {"command_name": "show", "command_wall_clock_time": 0.23542042, "process_user_time": 0.94749, "process_kernel_time": 0.081014, "process_mem_max_rss": "115916800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:25:08.940443 [debug] [MainThread]: Command `dbt show` failed at 00:25:08.940374 after 0.24 seconds
[0m00:25:08.940665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106486f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064ac620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105818680>]}
[0m00:25:08.940839 [debug] [MainThread]: Flushing usage events
[0m18:52:50.703051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f75a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc98b0>]}


============================== 18:52:50.705899 | 6f28dfac-64f3-4078-a8d2-51a1a39011e5 ==============================
[0m18:52:50.705899 [info ] [MainThread]: Running with dbt=1.7.14
[0m18:52:50.706271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/charles/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/charles/Documents/dbt_meetup4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:51.091271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f28dfac-64f3-4078-a8d2-51a1a39011e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105066f90>]}
[0m18:52:51.116612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f28dfac-64f3-4078-a8d2-51a1a39011e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105471a30>]}
[0m18:52:51.117126 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m18:52:51.121744 [debug] [MainThread]: checksum: ccbe0bccecb23e0b0bcca76d525b7d642e28acd474046360f7f33e61c6a2b781, vars: {}, profile: , target: , version: 1.7.14
[0m18:52:51.148104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:51.148415 [debug] [MainThread]: Partial parsing: updated file: dbt_meetup4://models/intermediate/fivetran.sql
[0m18:52:51.196546 [info ] [MainThread]: Warning: The placeholder_column_categorical macro is being used
[0m18:52:51.203345 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_meetup4.fivetran' (models/intermediate/fivetran.sql) depends on a source named 'dev_cgray.career_phase' which was not found
[0m18:52:51.208627 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.53445584, "process_user_time": 1.024547, "process_kernel_time": 0.14333, "process_mem_max_rss": "117555200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:52:51.209055 [debug] [MainThread]: Command `dbt docs generate` failed at 18:52:51.208984 after 0.53 seconds
[0m18:52:51.209273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106101070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060afb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c59fd0>]}
[0m18:52:51.209530 [debug] [MainThread]: Flushing usage events
